<!doctype html>
<html class="default no-js">
<head>
	<meta charset="utf-8">
	<meta http-equiv="X-UA-Compatible" content="IE=edge">
	<title>zeebe-node</title>
	<meta name="description" content="Documentation for zeebe-node">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<link rel="stylesheet" href="assets/css/main.css">
	<script async src="assets/js/search.js" id="search-script"></script>
</head>
<body>
<header>
	<div class="tsd-page-toolbar">
		<div class="container">
			<div class="table-wrap">
				<div class="table-cell" id="tsd-search" data-index="assets/js/search.json" data-base=".">
					<div class="field">
						<label for="tsd-search-field" class="tsd-widget search no-caption">Search</label>
						<input id="tsd-search-field" type="text" />
					</div>
					<ul class="results">
						<li class="state loading">Preparing search index...</li>
						<li class="state failure">The search index is not available</li>
					</ul>
					<a href="index.html" class="title">zeebe-node</a>
				</div>
				<div class="table-cell" id="tsd-widgets">
					<div id="tsd-filter">
						<a href="#" class="tsd-widget options no-caption" data-toggle="options">Options</a>
						<div class="tsd-filter-group">
							<div class="tsd-select" id="tsd-filter-visibility">
								<span class="tsd-select-label">All</span>
								<ul class="tsd-select-list">
									<li data-value="public">Public</li>
									<li data-value="protected">Public/Protected</li>
									<li data-value="private" class="selected">All</li>
								</ul>
							</div>
							<input type="checkbox" id="tsd-filter-inherited" checked />
							<label class="tsd-widget" for="tsd-filter-inherited">Inherited</label>
							<input type="checkbox" id="tsd-filter-externals" checked />
							<label class="tsd-widget" for="tsd-filter-externals">Externals</label>
						</div>
					</div>
					<a href="#" class="tsd-widget menu no-caption" data-toggle="menu">Menu</a>
				</div>
			</div>
		</div>
	</div>
	<div class="tsd-page-title">
		<div class="container">
			<h1>zeebe-node</h1>
		</div>
	</div>
</header>
<div class="container container-main">
	<div class="row">
		<div class="col-8 col-content">
			<div class="tsd-panel tsd-typography">
				<a href="#zeebe-nodejs-client" id="zeebe-nodejs-client" style="color: inherit; text-decoration: none;">
					<h1>Zeebe Node.js Client</h1>
				</a>
				<p><img src="https://img.shields.io/badge/Compatible%20with-Camunda%20Platform%208-0072Ce" alt="Compatible with: Camunda Platform 8">
					<img src="https://img.shields.io/badge/Community%20Extension-An%20open%20source%20community%20maintained%20project-FF4700" alt="Community Extension">
					<img src="https://img.shields.io/badge/Lifecycle-Stable-brightgreen" alt="Lifecycle">
				<a href="https://opensource.org/licenses/Apache-2.0"><img src="https://img.shields.io/badge/License-Apache%202.0-blue.svg" alt="License"></a></p>
				<p>This is a Node.js gRPC client for <a href="https://zeebe.io">Zeebe</a>, the workflow engine in <a href="https://camunda.com/platform/">Camunda Platform 8</a>. It is written in TypeScript and transpiled to JavaScript in the <code>dist</code> directory.</p>
				<p>Comprehensive API documentation is available <a href="https://camunda-community-hub.github.io/zeebe-client-node-js/">online</a>.</p>
				<p>See <a href="https://github.com/camunda-community-hub/zeebe-client-node-js/blob/master/CHANGELOG.md">CHANGELOG.md</a> to see what has changed with each release.</p>
				<p>Get a hosted instance of Zeebe on <a href="https://camunda.io">Camunda Cloud</a>.</p>
				<a href="#table-of-contents" id="table-of-contents" style="color: inherit; text-decoration: none;">
					<h2>Table of Contents</h2>
				</a>
				<p><strong>Quick Start</strong></p>
				<ul>
					<li><p><a href="#install"> Install </a></p>
					</li>
					<li><p><a href="#get-topology"> Get Broker Topology </a></p>
					</li>
					<li><p><a href="#deploy-process"> Deploy a process </a></p>
					</li>
					<li><p><a href="#start-and-service-a-process"> Start and service a process</a></p>
					</li>
					<li><p><a href="#versioning"> Versioning </a></p>
					</li>
					<li><p><a href="#node-versions"> Compatible Node Versions </a></p>
					</li>
					<li><p><a href="#breaking-8.1.0"> Breaking changes in 8.1.0 </a></p>
					</li>
					<li><p><a href="#breaking-1.0.0"> Breaking changes in 1.0.0 </a></p>
					</li>
					<li><p><a href="#grpc-implementation"> gRPC Implementation </a></p>
					</li>
					<li><p><a href="#type-difference"> Type difference from other Zeebe clients </a></p>
					</li>
					<li><p><a href="#time-duration"> A note on representing timeout durations </a></p>
					</li>
				</ul>
				<p><strong>Connection Behaviour</strong></p>
				<ul>
					<li><a href="#client-side-retry"> Client-side gRPC retry in ZBClient </a></li>
					<li><a href="#on-ready"> onReady(), onConnectionError(), and connected </a></li>
					<li><a href="#initial-connection-tolerance"> Initial Connection Tolerance </a></li>
				</ul>
				<p><strong>Connecting to a Broker</strong></p>
				<ul>
					<li><a href="#tls"> TLS </a></li>
					<li><a href="#oauth"> OAuth </a></li>
					<li><a href="#basic-auth"> Basic Auth </a></li>
					<li><a href="#camunda-cloud"> Camunda Cloud </a></li>
					<li><a href="#zero-conf"> Zero-conf constructor </a></li>
				</ul>
				<p><strong>Job Workers</strong></p>
				<ul>
					<li><a href="#job-workers"> Job Workers</a></li>
					<li><a href="#create-zbworker"> The <code>ZBWorker</code> Job Worker </a></li>
					<li><a href="#unhandled-exceptions"> Unhandled Exceptions in Task Handlers </a></li>
					<li><a href="#complete-tasks"> Completing tasks with success, failure, error, or forwarded </a></li>
					<li><a href="#working-with-variables"> Working with Process Variables and Custom Headers </a></li>
					<li><a href="#fetch-variable"> Constraining the Variables Fetched by the Worker </a></li>
					<li><a href="#decoupled-complete"> The &quot;Decoupled Job Completion&quot; pattern </a></li>
					<li><a href="#zbbatchworker"> The <code>ZBBatchWorker</code> Job Worker </a></li>
					<li><a href="#long-polling"> Long polling </a></li>
					<li><a href="#poll-interval"> Poll Interval </a></li>
				</ul>
				<p><strong>Client Commands</strong></p>
				<ul>
					<li><a href="#deploy-resource"> Deploy Process Models and DMN Tables </a></li>
					<li><a href="#start-process"> Start a Process Instance </a></li>
					<li><a href="#start-specific-version"> Start a Process Instance of a specific version of a Process definition </a></li>
					<li><a href="#start-await"> Start a process instance and await the process outcome </a></li>
					<li><a href="#publish-message"> Publish a Message </a></li>
					<li><a href="#publish-start-message"> Publish a Start Message </a></li>
					<li><a href="#activate-jobs"> Activate Jobs </a></li>
				</ul>
				<p><strong>Other Concerns</strong></p>
				<ul>
					<li><a href="#graceful-shutdown"> Graceful Shutdown </a></li>
					<li><a href="#logging"> Logging </a></li>
				</ul>
				<p><strong>Programming with Safety</strong></p>
				<ul>
					<li><a href="#generate-constants"> Generating TypeScript constants for BPMN Models </a></li>
					<li><a href="#generate-code"> Generating code from a BPM Model file </a></li>
					<li><a href="#strongly-typed"> Writing Strongly-typed Job Workers </a></li>
					<li><a href="#run-time-safety"> Run-time Type Safety </a></li>
				</ul>
				<p><strong>Development of the Library itself</strong></p>
				<ul>
					<li><a href="#developing"> Developing Zeebe Node </a><ul>
							<li><a href="#tests"> Tests </a></li>
							<li><a href="#writing-tests"> Writing Tests </a></li>
						</ul>
					</li>
					<li><a href="#contributors"> Contributors </a></li>
				</ul>
				<a href="#quick-start" id="quick-start" style="color: inherit; text-decoration: none;">
					<h2>Quick Start</h2>
				</a>
				<p><a name = "install"></a></p>
				<a href="#install" id="install" style="color: inherit; text-decoration: none;">
					<h2>Install</h2>
				</a>
				<a href="#add-the-library-to-your-project" id="add-the-library-to-your-project" style="color: inherit; text-decoration: none;">
					<h3>Add the Library to your Project</h3>
				</a>
				<pre><code class="language-bash"><span style="color: #000000">npm i zeebe-node</span>
</code></pre>
				<p>For Zeebe broker versions prior to 1.0.0:</p>
				<pre><code class="language-bash"><span style="color: #000000">npm i zeebe-node@0</span>
</code></pre>
				<p>Refer to <a href="https://github.com/camunda-community-hub/zeebe-client-node-js/blob/v.0.25.0/README.md">here</a> for the documentation for the pre-1.0.0 version of the library.</p>
				<p><a name = "get-topology"></a></p>
				<a href="#get-broker-topology" id="get-broker-topology" style="color: inherit; text-decoration: none;">
					<h3>Get Broker Topology</h3>
				</a>
				<pre><code class="language-javascript"><span style="color: #0000FF">const</span><span style="color: #000000"> </span><span style="color: #0070C1">ZB</span><span style="color: #000000"> = </span><span style="color: #795E26">require</span><span style="color: #000000">(</span><span style="color: #A31515">&#039;zeebe-node&#039;</span><span style="color: #000000">)</span>

<span style="color: #0000FF">void</span><span style="color: #000000"> (</span><span style="color: #0000FF">async</span><span style="color: #000000"> () </span><span style="color: #0000FF">=&gt;</span><span style="color: #000000"> {</span>
<span style="color: #000000">    </span><span style="color: #0000FF">const</span><span style="color: #000000"> </span><span style="color: #0070C1">zbc</span><span style="color: #000000"> = </span><span style="color: #0000FF">new</span><span style="color: #000000"> </span><span style="color: #0070C1">ZB</span><span style="color: #000000">.</span><span style="color: #795E26">ZBClient</span><span style="color: #000000">()</span>
<span style="color: #000000">    </span><span style="color: #0000FF">const</span><span style="color: #000000"> </span><span style="color: #0070C1">topology</span><span style="color: #000000"> = </span><span style="color: #AF00DB">await</span><span style="color: #000000"> </span><span style="color: #001080">zbc</span><span style="color: #000000">.</span><span style="color: #795E26">topology</span><span style="color: #000000">()</span>
<span style="color: #000000">    </span><span style="color: #001080">console</span><span style="color: #000000">.</span><span style="color: #795E26">log</span><span style="color: #000000">(</span><span style="color: #267F99">JSON</span><span style="color: #000000">.</span><span style="color: #795E26">stringify</span><span style="color: #000000">(</span><span style="color: #001080">topology</span><span style="color: #000000">, </span><span style="color: #0000FF">null</span><span style="color: #000000">, </span><span style="color: #098658">2</span><span style="color: #000000">))</span>
<span style="color: #000000">})()</span>
</code></pre>
				<p><a name = "deploy-process"></a></p>
				<a href="#deploy-a-process" id="deploy-a-process" style="color: inherit; text-decoration: none;">
					<h3>Deploy a process</h3>
				</a>
				<pre><code class="language-javascript"><span style="color: #0000FF">const</span><span style="color: #000000"> </span><span style="color: #0070C1">ZB</span><span style="color: #000000"> = </span><span style="color: #795E26">require</span><span style="color: #000000">(</span><span style="color: #A31515">&#039;zeebe-node&#039;</span><span style="color: #000000">)</span>
<span style="color: #0000FF">const</span><span style="color: #000000"> </span><span style="color: #0070C1">fs</span><span style="color: #000000"> = </span><span style="color: #795E26">require</span><span style="color: #000000">(</span><span style="color: #A31515">&#039;fs&#039;</span><span style="color: #000000">)</span>

<span style="color: #0000FF">void</span><span style="color: #000000"> (</span><span style="color: #0000FF">async</span><span style="color: #000000"> () </span><span style="color: #0000FF">=&gt;</span><span style="color: #000000"> {</span>
<span style="color: #000000">    </span><span style="color: #0000FF">const</span><span style="color: #000000"> </span><span style="color: #0070C1">zbc</span><span style="color: #000000"> = </span><span style="color: #0000FF">new</span><span style="color: #000000"> </span><span style="color: #0070C1">ZB</span><span style="color: #000000">.</span><span style="color: #795E26">ZBClient</span><span style="color: #000000">() </span><span style="color: #008000">// localhost:26500 || ZEEBE_GATEWAY_ADDRESS</span>

<span style="color: #000000">    </span><span style="color: #0000FF">const</span><span style="color: #000000"> </span><span style="color: #0070C1">res</span><span style="color: #000000"> = </span><span style="color: #AF00DB">await</span><span style="color: #000000"> </span><span style="color: #001080">zbc</span><span style="color: #000000">.</span><span style="color: #795E26">deployProcess</span><span style="color: #000000">(</span><span style="color: #A31515">&#039;./domain-mutation.bpmn&#039;</span><span style="color: #000000">)</span>
<span style="color: #000000">    </span><span style="color: #001080">console</span><span style="color: #000000">.</span><span style="color: #795E26">log</span><span style="color: #000000">(</span><span style="color: #001080">res</span><span style="color: #000000">)</span>

<span style="color: #000000">    </span><span style="color: #008000">// Deploy multiple with an array of filepaths</span>
<span style="color: #000000">    </span><span style="color: #AF00DB">await</span><span style="color: #000000"> </span><span style="color: #001080">zbc</span><span style="color: #000000">.</span><span style="color: #795E26">deployProcess</span><span style="color: #000000">([</span><span style="color: #A31515">&#039;./wf1.bpmn&#039;</span><span style="color: #000000">, </span><span style="color: #A31515">&#039;./wf2.bpmn&#039;</span><span style="color: #000000">])</span>

<span style="color: #000000">    </span><span style="color: #0000FF">const</span><span style="color: #000000"> </span><span style="color: #0070C1">buffer</span><span style="color: #000000"> = </span><span style="color: #001080">fs</span><span style="color: #000000">.</span><span style="color: #795E26">readFileSync</span><span style="color: #000000">(</span><span style="color: #A31515">&#039;./wf3.bpmn&#039;</span><span style="color: #000000">)</span>

<span style="color: #000000">    </span><span style="color: #008000">// Deploy from an in-memory buffer</span>
<span style="color: #000000">    </span><span style="color: #AF00DB">await</span><span style="color: #000000"> </span><span style="color: #001080">zbc</span><span style="color: #000000">.</span><span style="color: #795E26">deployProcess</span><span style="color: #000000">({ </span><span style="color: #001080">definition:</span><span style="color: #000000"> </span><span style="color: #001080">buffer</span><span style="color: #000000">, </span><span style="color: #001080">name:</span><span style="color: #000000"> </span><span style="color: #A31515">&#039;wf3.bpmn&#039;</span><span style="color: #000000"> })</span>
<span style="color: #000000">})()</span>
</code></pre>
				<p><a name = "start-and-service-process"></a></p>
				<a href="#start-and-service-a-process" id="start-and-service-a-process" style="color: inherit; text-decoration: none;">
					<h3>Start and service a process</h3>
				</a>
				<p>This code demonstrates how to deploy a Zeebe process, create a process instance, and handle a service task using the Zeebe Node.js client. The &#39;get-customer-record&#39; service task worker checks for the presence of a customerId variable, simulates fetching a customer record from a database, and completes the task with a customerRecordExists variable.</p>
				<pre><code class="language-javascript"><span style="color: #008000">// Import the Zeebe Node.js client and the &#039;fs&#039; module</span>
<span style="color: #0000FF">const</span><span style="color: #000000"> </span><span style="color: #0070C1">ZB</span><span style="color: #000000"> = </span><span style="color: #795E26">require</span><span style="color: #000000">(</span><span style="color: #A31515">&#039;zeebe-node&#039;</span><span style="color: #000000">);</span>
<span style="color: #0000FF">const</span><span style="color: #000000"> </span><span style="color: #0070C1">fs</span><span style="color: #000000"> = </span><span style="color: #795E26">require</span><span style="color: #000000">(</span><span style="color: #A31515">&#039;fs&#039;</span><span style="color: #000000">);</span>

<span style="color: #008000">// Instantiate a Zeebe client with default localhost settings or environment variables</span>
<span style="color: #0000FF">const</span><span style="color: #000000"> </span><span style="color: #0070C1">zbc</span><span style="color: #000000"> = </span><span style="color: #0000FF">new</span><span style="color: #000000"> </span><span style="color: #0070C1">ZB</span><span style="color: #000000">.</span><span style="color: #795E26">ZBClient</span><span style="color: #000000">();</span>

<span style="color: #008000">// Create a Zeebe worker to handle the &#039;get-customer-record&#039; service task</span>
<span style="color: #0000FF">const</span><span style="color: #000000"> </span><span style="color: #0070C1">worker</span><span style="color: #000000"> = </span><span style="color: #001080">zbc</span><span style="color: #000000">.</span><span style="color: #795E26">createWorker</span><span style="color: #000000">({</span>
<span style="color: #000000">    </span><span style="color: #008000">// Define the task type that this worker will process</span>
<span style="color: #000000">    </span><span style="color: #001080">taskType:</span><span style="color: #000000"> </span><span style="color: #A31515">&#039;get-customer-record&#039;</span><span style="color: #000000">,</span>
<span style="color: #000000">    </span><span style="color: #008000">// Define the task handler to process incoming jobs</span>
<span style="color: #000000">    </span><span style="color: #795E26">taskHandler</span><span style="color: #001080">:</span><span style="color: #000000"> </span><span style="color: #001080">job</span><span style="color: #000000"> </span><span style="color: #0000FF">=&gt;</span><span style="color: #000000"> {</span>
<span style="color: #000000">        </span><span style="color: #008000">// Log the job variables for debugging purposes</span>
<span style="color: #000000">        </span><span style="color: #001080">console</span><span style="color: #000000">.</span><span style="color: #795E26">log</span><span style="color: #000000">(</span><span style="color: #001080">job</span><span style="color: #000000">.</span><span style="color: #001080">variables</span><span style="color: #000000">);</span>

<span style="color: #000000">        </span><span style="color: #008000">// Check if the customerId variable is missing and return an error if so</span>
<span style="color: #000000">        </span><span style="color: #AF00DB">if</span><span style="color: #000000"> (!</span><span style="color: #001080">job</span><span style="color: #000000">.</span><span style="color: #001080">variables</span><span style="color: #000000">.</span><span style="color: #001080">customerId</span><span style="color: #000000">) {</span>
<span style="color: #000000">            </span><span style="color: #AF00DB">return</span><span style="color: #000000"> </span><span style="color: #001080">job</span><span style="color: #000000">.</span><span style="color: #795E26">error</span><span style="color: #000000">(</span><span style="color: #A31515">&#039;NO_CUSTID&#039;</span><span style="color: #000000">, </span><span style="color: #A31515">&#039;Missing customerId in process variables&#039;</span><span style="color: #000000">);</span>
<span style="color: #000000">        }</span>

<span style="color: #000000">        </span><span style="color: #008000">// Add logic to retrieve the customer record from the database here</span>
<span style="color: #000000">        </span><span style="color: #008000">// ...</span>

<span style="color: #000000">        </span><span style="color: #008000">// Complete the job with the &#039;customerRecordExists&#039; variable set to true</span>
<span style="color: #000000">        </span><span style="color: #AF00DB">return</span><span style="color: #000000"> </span><span style="color: #001080">job</span><span style="color: #000000">.</span><span style="color: #795E26">complete</span><span style="color: #000000">({</span>
<span style="color: #000000">            </span><span style="color: #001080">customerRecordExists:</span><span style="color: #000000"> </span><span style="color: #0000FF">true</span>
<span style="color: #000000">        });</span>
<span style="color: #000000">    }</span>
<span style="color: #000000">});</span>

<span style="color: #008000">// Define an async main function to deploy a process, create a process instance, and log the outcome</span>
<span style="color: #0000FF">async</span><span style="color: #000000"> </span><span style="color: #0000FF">function</span><span style="color: #000000"> </span><span style="color: #795E26">main</span><span style="color: #000000">() {</span>
<span style="color: #000000">    </span><span style="color: #008000">// Deploy the &#039;new-customer.bpmn&#039; process</span>
<span style="color: #000000">    </span><span style="color: #0000FF">const</span><span style="color: #000000"> </span><span style="color: #0070C1">res</span><span style="color: #000000"> = </span><span style="color: #AF00DB">await</span><span style="color: #000000"> </span><span style="color: #001080">zbc</span><span style="color: #000000">.</span><span style="color: #795E26">deployProcess</span><span style="color: #000000">(</span><span style="color: #A31515">&#039;./new-customer.bpmn&#039;</span><span style="color: #000000">);</span>
<span style="color: #000000">    </span><span style="color: #008000">// Log the deployment result</span>
<span style="color: #000000">    </span><span style="color: #001080">console</span><span style="color: #000000">.</span><span style="color: #795E26">log</span><span style="color: #000000">(</span><span style="color: #A31515">&#039;Deployed process:&#039;</span><span style="color: #000000">, </span><span style="color: #267F99">JSON</span><span style="color: #000000">.</span><span style="color: #795E26">stringify</span><span style="color: #000000">(</span><span style="color: #001080">res</span><span style="color: #000000">, </span><span style="color: #0000FF">null</span><span style="color: #000000">, </span><span style="color: #098658">2</span><span style="color: #000000">));</span>

<span style="color: #000000">    </span><span style="color: #008000">// Create a process instance of the &#039;new-customer-process&#039; process, with a customerId variable set</span>
<span style="color: #000000">    </span><span style="color: #008000">// &#039;createProcessInstanceWithResult&#039; awaits the outcome</span>
<span style="color: #000000">    </span><span style="color: #0000FF">const</span><span style="color: #000000"> </span><span style="color: #0070C1">outcome</span><span style="color: #000000"> = </span><span style="color: #AF00DB">await</span><span style="color: #000000"> </span><span style="color: #001080">zbc</span><span style="color: #000000">.</span><span style="color: #795E26">createProcessInstanceWithResult</span><span style="color: #000000">({</span>
<span style="color: #000000">        </span><span style="color: #001080">bpmnProcessId:</span><span style="color: #000000"> </span><span style="color: #A31515">&#039;new-customer-process&#039;</span><span style="color: #000000">,</span>
<span style="color: #000000">        </span><span style="color: #001080">variables:</span><span style="color: #000000"> { </span><span style="color: #001080">customerId:</span><span style="color: #000000"> </span><span style="color: #098658">457</span><span style="color: #000000"> }</span>
<span style="color: #000000">    });</span>
<span style="color: #000000">    </span><span style="color: #008000">// Log the process outcome</span>
<span style="color: #000000">    </span><span style="color: #001080">console</span><span style="color: #000000">.</span><span style="color: #795E26">log</span><span style="color: #000000">(</span><span style="color: #A31515">&#039;Process outcome&#039;</span><span style="color: #000000">, </span><span style="color: #267F99">JSON</span><span style="color: #000000">.</span><span style="color: #795E26">stringify</span><span style="color: #000000">(</span><span style="color: #001080">outcome</span><span style="color: #000000">, </span><span style="color: #0000FF">null</span><span style="color: #000000">, </span><span style="color: #098658">2</span><span style="color: #000000">));</span>
<span style="color: #000000">}</span>

<span style="color: #008000">// Call the main function to execute the script</span>
<span style="color: #795E26">main</span><span style="color: #000000">();</span>
</code></pre>
				<p><a name = "versioning"></a></p>
				<a href="#versioning" id="versioning" style="color: inherit; text-decoration: none;">
					<h2>Versioning</h2>
				</a>
				<p>To enable that the client libraries can be easily supported to the Zeebe server we map the version numbers, so that Major, Minor match the server application. Patches are independent and indicate client updates.</p>
				<p>NPM Package version 0.26.x supports Zeebe 0.22.x to 0.26.x.</p>
				<p>NPM Package version 1.x supports Zeebe 1.x. It uses the C-based gRPC library by default.</p>
				<p>NPM Package version 2.x supports Zeebe 1.x, and requires Node &gt;= 16.6.1, &gt;=14.17.5, or &gt;=12.22.5. It removes the C-based gRPC library and uses the pure JS implementation.</p>
				<p><a name="node-versions"></a></p>
				<a href="#compatible-node-versions" id="compatible-node-versions" style="color: inherit; text-decoration: none;">
					<h2>Compatible Node Versions</h2>
				</a>
				<p>Version 1.x of the package: Node versions &lt;=16.x. Version 1.x uses the C-based gRPC library and does not work with Node 17. The C-based gRPC library is deprecated and no longer being maintained.</p>
				<p>Version 2.x and later of the package: Node versions 12.22.5+, 14.17.5+, or 16.6.1+. Version 2.x uses the pure JS implementation of the gRPC library, and requires a fix to the <code>nghttp2</code> library in Node (See <a href="https://github.com/camunda-community-hub/zeebe-client-node-js/issues/201">#201</a>).</p>
				<p><a name="breaking-8.1.0"></a></p>
				<a href="#breaking-changes-in-zeebe-810" id="breaking-changes-in-zeebe-810" style="color: inherit; text-decoration: none;">
					<h2>Breaking changes in Zeebe 8.1.0</h2>
				</a>
				<p>All deprecated APIs are removed in the 8.1.0 package version. If your code relies on deprecated methods and method signatures, you need to use a package version prior to 8.1.0 or update your application code.</p>
				<p><a name="breaking-1.0.0"></a></p>
				<a href="#breaking-changes-in-zeebe-100" id="breaking-changes-in-zeebe-100" style="color: inherit; text-decoration: none;">
					<h2>Breaking changes in Zeebe 1.0.0</h2>
				</a>
				<p>For Zeebe brokers prior to 1.0.0, use the 0.26.z version of <code>zeebe-node</code>. This README documents the Zeebe 1.0.0 API. The previous API is documented <a href="https://github.com/camunda-community-hub/zeebe-client-node-js/blob/v.0.25.0/README.md">here</a>.</p>
				<p>Zeebe 1.0.0 contains a number of breaking changes, including the gRPC protocol and the API surface area. You must use a 1.x.y version of the client library with Zeebe 1.0.0 and later.</p>
				<p>The pre-1.0.0 API of the Node client has been deprecated, but not removed. This means that your pre-1.0.0 applications should still work, just by changing the version of <code>zeebe-node</code> in the <code>package.json</code>.</p>
				<p><a name="grpc-implementation"></a></p>
				<a href="#grpc-implementation" id="grpc-implementation" style="color: inherit; text-decoration: none;">
					<h2>gRPC Implementation</h2>
				</a>
				<p>From version 2.x, the Zeebe Node client uses the pure JS gRPC client implementation.</p>
				<p>For version 1.x, the Zeebe Node client uses the C gRPC client implementation <a href="https://github.com/grpc/grpc-node">grpc-node</a> by default. The C-based gRPC implementation is deprecated and is not being maintained.</p>
				<p><a name = "type-difference"></a></p>
				<a href="#type-difference-from-other-zeebe-clients" id="type-difference-from-other-zeebe-clients" style="color: inherit; text-decoration: none;">
					<h2>Type difference from other Zeebe clients</h2>
				</a>
				<p>Protobuf fields of type <code>int64</code> are serialised as type string in the Node library. These fields are serialised as numbers (long) in the Go and Java client. See <a href="https://github.com/grpc/grpc/issues/7229">grpc/#7229</a> for why the Node library serialises them as string. The Process instance key, and other fields that are of type long in other client libraries, are type string in this library. Fields of type <code>int32</code> are serialised as type number in the Node library.</p>
				<p><a name = "time-duration"></a></p>
				<a href="#a-note-on-representing-timeout-durations" id="a-note-on-representing-timeout-durations" style="color: inherit; text-decoration: none;">
					<h2>A note on representing timeout durations</h2>
				</a>
				<p>All timeouts are ultimately communicated in <em>milliseconds</em>. They can be specified using the primitive type <code>number</code>, and this is always a <em>number of milliseconds</em>.</p>
				<p>All timeouts in the client library can <em>also</em>, optionally, be specified by a time value that encodes the units, using the <a href="https://www.npmjs.com/package/typed-duration">typed-durations</a> package. You can specify durations for timeouts like this:</p>
				<pre><code><span style="color: #0000FF">const</span><span style="color: #000000"> { </span><span style="color: #0070C1">Duration</span><span style="color: #000000"> } = </span><span style="color: #795E26">require</span><span style="color: #000000">(</span><span style="color: #A31515">&#039;zeebe-node&#039;</span><span style="color: #000000">)</span>

<span style="color: #0000FF">const</span><span style="color: #000000"> </span><span style="color: #0070C1">timeoutS</span><span style="color: #000000"> = </span><span style="color: #001080">Duration</span><span style="color: #000000">.</span><span style="color: #001080">seconds</span><span style="color: #000000">.</span><span style="color: #795E26">of</span><span style="color: #000000">(</span><span style="color: #098658">30</span><span style="color: #000000">) </span><span style="color: #008000">// 30s timeout</span>
<span style="color: #0000FF">const</span><span style="color: #000000"> </span><span style="color: #0070C1">timeoutMs</span><span style="color: #000000"> = </span><span style="color: #001080">Duration</span><span style="color: #000000">.</span><span style="color: #001080">milliseconds</span><span style="color: #000000">.</span><span style="color: #795E26">of</span><span style="color: #000000">(</span><span style="color: #098658">30000</span><span style="color: #000000">) </span><span style="color: #008000">// 30s timeout in milliseconds</span>
</code></pre>
				<p>Using the value types makes your code more semantically specific.</p>
				<p>There are five timeouts to take into account.</p>
				<p>The first is the job <code>timeout</code>. This is the amount of time that the broker allocates exclusive responsibility for a job to a worker instance. By default, this is 60 seconds. This is the default value set by this client library. See &quot;<a href="#job-workers">Job Workers</a>&quot;.</p>
				<p>The second is the <code>requestTimeout</code>. Whenever the client library sends a gRPC command to the broker, it has an explicit or implied <code>requestTimeout</code>. This is the amount of time that the gRPC gateway will wait for a response from the broker cluster before returning a <code>4 DEADLINE</code> gRPC error response.</p>
				<p>If no <code>requestTimeout</code> is specified, then the configured timeout of the broker gateway is used. Out of the box, this is 15 seconds by default.</p>
				<p>The most significant use of the <code>requestTimeout</code> is when using the <code>createProcessInstanceWithResult</code> command. If your process will take longer than 15 seconds to complete, you should specify a <code>requestTimeout</code>. See &quot;<a href="#start-await">Start a Process Instance and await the Process Outcome</a>&quot;.</p>
				<p>The third is the <code>longpoll</code> duration. This is the amount of time that the job worker holds a long poll request to activate jobs open.</p>
				<p>The fourth is the maximum back-off delay in client-side gRPC command retries. See &quot;<a href="#client-side-retry">Client-side gRPC retry in ZBClient</a>&quot;.</p>
				<p>Finally, the <code>connectionTolerance</code> option for ZBClient can also take a typed duration. This value is used to buffer reporting connection errors while establishing a connection - for example with Camunda SaaS, which requires a token exchange as part of the connection process.</p>
				<a href="#connection-behaviour" id="connection-behaviour" style="color: inherit; text-decoration: none;">
					<h2>Connection Behaviour</h2>
				</a>
				<p><a name = "client-side-retry"></a></p>
				<a href="#client-side-grpc-retry-in-zbclient" id="client-side-grpc-retry-in-zbclient" style="color: inherit; text-decoration: none;">
					<h3>Client-side gRPC retry in ZBClient</h3>
				</a>
				<p>If a gRPC command method fails in the ZBClient - such as <code>ZBClient.deployProcess</code> or <code>ZBClient.topology()</code>, the underlying gRPC library will throw an exception.</p>
				<p>If no workers have been started, this can be fatal to the process if it is not handled by the application logic. This is especially an issue when a worker container starts before the Zeebe gRPC gateway is available to service requests, and can be inconsistent as this is a race condition.</p>
				<p>To mitigate against this, the Node client implements some client-side gRPC operation retry logic by default. This can be configured, including disabled, via configuration in the client constructor.</p>
				<ul>
					<li>Operations retry, but only for <a href="https://github.com/grpc/grpc/blob/master/doc/statuscodes.md">gRPC error codes 8 and 14</a> - indicating resource exhaustion (8) or transient network failure (14). Resource exhaustion occurs when the broker starts backpressure due to latency because of load. Network failure can be caused by passing in an unresolvable gateway address (<code>14: DNS Resolution failed</code>), or by the gateway not being ready yet (<code>14: UNAVAILABLE: failed to connect to all addresses</code>).</li>
					<li>Operations that fail for other reasons, such as deploying an invalid bpmn file or cancelling a process that does not exist, do not retry.</li>
					<li>Retry is enabled by default, and can be disabled by passing { retry: false } to the client constructor.</li>
					<li>Values for <code>retry</code>, <code>maxRetries</code> and <code>maxRetryTimeout</code> can be configured via the environment variables <code>ZEEBE_CLIENT_RETRY</code>, <code>ZEEBE_CLIENT_MAX_RETRIES</code> and <code>ZEEBE_CLIENT_MAX_RETRY_TIMEOUT</code> respectively.</li>
					<li><code>maxRetries</code> and <code>maxRetryTimeout</code> are also configurable through the constructor options, or through environment variables. By default, if not supplied, the values are:</li>
				</ul>
				<pre><code class="language-TypeScript"><span style="color: #0000FF">const</span><span style="color: #000000"> { </span><span style="color: #0070C1">ZBClient</span><span style="color: #000000">, </span><span style="color: #0070C1">Duration</span><span style="color: #000000"> } = </span><span style="color: #795E26">require</span><span style="color: #000000">(</span><span style="color: #A31515">&#039;zeebe-node&#039;</span><span style="color: #000000">)</span>

<span style="color: #0000FF">const</span><span style="color: #000000"> </span><span style="color: #0070C1">zbc</span><span style="color: #000000"> = </span><span style="color: #0000FF">new</span><span style="color: #000000"> </span><span style="color: #795E26">ZBClient</span><span style="color: #000000">(</span><span style="color: #001080">gatewayAddress</span><span style="color: #000000">, {</span>
<span style="color: #000000">    </span><span style="color: #001080">retry:</span><span style="color: #000000"> </span><span style="color: #0000FF">true</span><span style="color: #000000">,</span>
<span style="color: #000000">    </span><span style="color: #001080">maxRetries:</span><span style="color: #000000"> -</span><span style="color: #098658">1</span><span style="color: #000000">, </span><span style="color: #008000">// infinite retries</span>
<span style="color: #000000">    </span><span style="color: #001080">maxRetryTimeout:</span><span style="color: #000000"> </span><span style="color: #001080">Duration</span><span style="color: #000000">.</span><span style="color: #001080">seconds</span><span style="color: #000000">.</span><span style="color: #795E26">of</span><span style="color: #000000">(</span><span style="color: #098658">5</span><span style="color: #000000">)</span>
<span style="color: #000000">})</span>
</code></pre>
				<p>The environment variables are:</p>
				<pre><code><span style="color: #0070C1">ZEEBE_CLIENT_MAX_RETRIES</span>
<span style="color: #0070C1">ZEEBE_CLIENT_RETRY</span>
<span style="color: #0070C1">ZEEBE_CLIENT_MAX_RETRY_TIMEOUT</span>
</code></pre>
				<p>Retry is provided by <a href="https://www.npmjs.com/package/promise-retry">promise-retry</a>, and the back-off strategy is simple ^2.</p>
				<p>Additionally, the gRPC Client will continually reconnect when in a failed state, such as when the gateway goes away due to pod rescheduling on Kubernetes.</p>
				<p><a name = "eager-connection"></a></p>
				<a href="#eager-connection" id="eager-connection" style="color: inherit; text-decoration: none;">
					<h3>Eager Connection</h3>
				</a>
				<p>The ZBClient eagerly connects to the broker by issuing a topology command in the constructor. This allows you an onReady event to be emitted. You can disable this (for example, for testing without a broker), by either passing <code>eagerConnection: false</code> to the client constructor options, or setting the environment variable <code>ZEEBE_NODE_EAGER_CONNECTION</code> to <code>false</code>.</p>
				<p><a name = "on-ready"></a></p>
				<a href="#onready-onconnectionerror-and-connected" id="onready-onconnectionerror-and-connected" style="color: inherit; text-decoration: none;">
					<h3>onReady(), onConnectionError(), and connected</h3>
				</a>
				<p>The client has a <code>connected</code> property that can be examined to determine if it has a gRPC connection to the gateway.</p>
				<p>The client and the worker can take an optional <code>onReady()</code> and <code>onConnectionError()</code> handler in their constructors, like this:</p>
				<pre><code class="language-TypeScript"><span style="color: #0000FF">const</span><span style="color: #000000"> { </span><span style="color: #0070C1">ZBClient</span><span style="color: #000000">, </span><span style="color: #0070C1">Duration</span><span style="color: #000000"> } = </span><span style="color: #795E26">require</span><span style="color: #000000">(</span><span style="color: #A31515">&#039;zeebe-node&#039;</span><span style="color: #000000">)</span>

<span style="color: #0000FF">const</span><span style="color: #000000"> </span><span style="color: #0070C1">zbc</span><span style="color: #000000"> = </span><span style="color: #0000FF">new</span><span style="color: #000000"> </span><span style="color: #795E26">ZBClient</span><span style="color: #000000">({</span>
<span style="color: #000000">    </span><span style="color: #795E26">onReady</span><span style="color: #001080">:</span><span style="color: #000000"> () </span><span style="color: #0000FF">=&gt;</span><span style="color: #000000"> </span><span style="color: #001080">console</span><span style="color: #000000">.</span><span style="color: #795E26">log</span><span style="color: #000000">(</span><span style="color: #A31515">`Connected!`</span><span style="color: #000000">),</span>
<span style="color: #000000">    </span><span style="color: #795E26">onConnectionError</span><span style="color: #001080">:</span><span style="color: #000000"> () </span><span style="color: #0000FF">=&gt;</span><span style="color: #000000"> </span><span style="color: #001080">console</span><span style="color: #000000">.</span><span style="color: #795E26">log</span><span style="color: #000000">(</span><span style="color: #A31515">`Disconnected!`</span><span style="color: #000000">)</span>
<span style="color: #000000">})</span>

<span style="color: #0000FF">const</span><span style="color: #000000"> </span><span style="color: #0070C1">zbWorker</span><span style="color: #000000"> = </span><span style="color: #001080">zbc</span><span style="color: #000000">.</span><span style="color: #795E26">createWorker</span><span style="color: #000000">({</span>
<span style="color: #000000">    </span><span style="color: #001080">taskType:</span><span style="color: #000000"> </span><span style="color: #A31515">&#039;demo-service&#039;</span><span style="color: #000000">,</span>
<span style="color: #000000">    </span><span style="color: #001080">taskHandler:</span><span style="color: #000000"> </span><span style="color: #001080">handler</span><span style="color: #000000">,</span>
<span style="color: #000000">    </span><span style="color: #795E26">onReady</span><span style="color: #001080">:</span><span style="color: #000000"> () </span><span style="color: #0000FF">=&gt;</span><span style="color: #000000"> </span><span style="color: #001080">console</span><span style="color: #000000">.</span><span style="color: #795E26">log</span><span style="color: #000000">(</span><span style="color: #A31515">`Worker connected!`</span><span style="color: #000000">),</span>
<span style="color: #000000">    </span><span style="color: #795E26">onConnectionError</span><span style="color: #001080">:</span><span style="color: #000000"> () </span><span style="color: #0000FF">=&gt;</span><span style="color: #000000"> </span><span style="color: #001080">console</span><span style="color: #000000">.</span><span style="color: #795E26">log</span><span style="color: #000000">(</span><span style="color: #A31515">`Worker disconnected!`</span><span style="color: #000000">)</span>
<span style="color: #000000">})</span>
</code></pre>
				<p>These handlers are called whenever the gRPC channel is established or lost. As the grpc channel will often &quot;jitter&quot; when it is lost (rapidly emitting READY and ERROR events at the transport layer), there is a <code>connectionTolerance</code> property that determines how long the connection must be in a connected or failed state before the handler is called. By default this is 3000ms.</p>
				<p>You can specify another value either in the constructor or via an environment variable.</p>
				<p>To specify it via an environment variable, set <code>ZEEBE_CONNECTION_TOLERANCE</code> to a number of milliseconds.</p>
				<p>To set it via the constructor, specify a value for <code>connectionTolerance</code> like this:</p>
				<pre><code class="language-TypeScript"><span style="color: #0000FF">const</span><span style="color: #000000"> { </span><span style="color: #0070C1">ZBClient</span><span style="color: #000000">, </span><span style="color: #0070C1">Duration</span><span style="color: #000000"> } = </span><span style="color: #795E26">require</span><span style="color: #000000">(</span><span style="color: #A31515">&#039;zeebe-node&#039;</span><span style="color: #000000">)</span>

<span style="color: #0000FF">const</span><span style="color: #000000"> </span><span style="color: #0070C1">zbc</span><span style="color: #000000"> = </span><span style="color: #0000FF">new</span><span style="color: #000000"> </span><span style="color: #795E26">ZBClient</span><span style="color: #000000">({</span>
<span style="color: #000000">    </span><span style="color: #795E26">onReady</span><span style="color: #001080">:</span><span style="color: #000000"> () </span><span style="color: #0000FF">=&gt;</span><span style="color: #000000"> </span><span style="color: #001080">console</span><span style="color: #000000">.</span><span style="color: #795E26">log</span><span style="color: #000000">(</span><span style="color: #A31515">`Connected!`</span><span style="color: #000000">),</span>
<span style="color: #000000">    </span><span style="color: #795E26">onConnectionError</span><span style="color: #001080">:</span><span style="color: #000000"> () </span><span style="color: #0000FF">=&gt;</span><span style="color: #000000"> </span><span style="color: #001080">console</span><span style="color: #000000">.</span><span style="color: #795E26">log</span><span style="color: #000000">(</span><span style="color: #A31515">`Disconnected!`</span><span style="color: #000000">),</span>
<span style="color: #000000">    </span><span style="color: #001080">connectionTolerance:</span><span style="color: #000000"> </span><span style="color: #098658">5000</span><span style="color: #000000"> </span><span style="color: #008000">// milliseconds</span>
<span style="color: #000000">})</span>

<span style="color: #0000FF">const</span><span style="color: #000000"> </span><span style="color: #0070C1">zbWorker</span><span style="color: #000000"> = </span><span style="color: #001080">zbc</span><span style="color: #000000">.</span><span style="color: #795E26">createWorker</span><span style="color: #000000">({</span>
<span style="color: #000000">    </span><span style="color: #001080">taskType:</span><span style="color: #000000"> </span><span style="color: #A31515">&#039;demo-service&#039;</span><span style="color: #000000">,</span>
<span style="color: #000000">    </span><span style="color: #001080">taskHandler:</span><span style="color: #000000"> </span><span style="color: #001080">handler</span><span style="color: #000000">,</span>
<span style="color: #000000">    </span><span style="color: #795E26">onReady</span><span style="color: #001080">:</span><span style="color: #000000"> () </span><span style="color: #0000FF">=&gt;</span><span style="color: #000000"> </span><span style="color: #001080">console</span><span style="color: #000000">.</span><span style="color: #795E26">log</span><span style="color: #000000">(</span><span style="color: #A31515">`Worker connected!`</span><span style="color: #000000">),</span>
<span style="color: #000000">    </span><span style="color: #795E26">onConnectionError</span><span style="color: #001080">:</span><span style="color: #000000"> () </span><span style="color: #0000FF">=&gt;</span><span style="color: #000000"> </span><span style="color: #001080">console</span><span style="color: #000000">.</span><span style="color: #795E26">log</span><span style="color: #000000">(</span><span style="color: #A31515">`Worker disconnected!`</span><span style="color: #000000">),</span>
<span style="color: #000000">    </span><span style="color: #001080">connectionTolerance:</span><span style="color: #000000"> </span><span style="color: #001080">Duration</span><span style="color: #000000">.</span><span style="color: #001080">seconds</span><span style="color: #000000">.</span><span style="color: #795E26">of</span><span style="color: #000000">(</span><span style="color: #098658">3.5</span><span style="color: #000000">) </span><span style="color: #008000">// 3500 milliseconds</span>
<span style="color: #000000">})</span>
</code></pre>
				<p>As well as the callback handlers, the client and workers extend the <a href="https://nodejs.org/api/events.html#events_class_eventemitter"><code>EventEmitter</code></a> class, and you can attach listeners to them for the &#39;ready&#39; and &#39;connectionError&#39; events:</p>
				<pre><code class="language-TypeScript"><span style="color: #0000FF">const</span><span style="color: #000000"> { </span><span style="color: #0070C1">ZBClient</span><span style="color: #000000">, </span><span style="color: #0070C1">Duration</span><span style="color: #000000"> } = </span><span style="color: #795E26">require</span><span style="color: #000000">(</span><span style="color: #A31515">&#039;zeebe-node&#039;</span><span style="color: #000000">)</span>

<span style="color: #0000FF">const</span><span style="color: #000000"> </span><span style="color: #0070C1">zbc</span><span style="color: #000000"> = </span><span style="color: #0000FF">new</span><span style="color: #000000"> </span><span style="color: #795E26">ZBClient</span><span style="color: #000000">()</span>

<span style="color: #0000FF">const</span><span style="color: #000000"> </span><span style="color: #0070C1">zbWorker</span><span style="color: #000000"> = </span><span style="color: #001080">zbc</span><span style="color: #000000">.</span><span style="color: #795E26">createWorker</span><span style="color: #000000">({</span>
<span style="color: #000000">    </span><span style="color: #001080">taskType:</span><span style="color: #000000"> </span><span style="color: #A31515">&#039;demo-service&#039;</span><span style="color: #000000">,</span>
<span style="color: #000000">    </span><span style="color: #001080">taskHandler:</span><span style="color: #000000"> </span><span style="color: #001080">handler</span><span style="color: #000000">,</span>
<span style="color: #000000">    </span><span style="color: #001080">connectionTolerance:</span><span style="color: #000000"> </span><span style="color: #001080">Duration</span><span style="color: #000000">.</span><span style="color: #001080">seconds</span><span style="color: #000000">.</span><span style="color: #795E26">of</span><span style="color: #000000">(</span><span style="color: #098658">3.5</span><span style="color: #000000">)</span>
<span style="color: #000000">})</span>

<span style="color: #001080">zbWorker</span><span style="color: #000000">.</span><span style="color: #795E26">on</span><span style="color: #000000">(</span><span style="color: #A31515">&#039;ready&#039;</span><span style="color: #000000">, () </span><span style="color: #0000FF">=&gt;</span><span style="color: #000000"> </span><span style="color: #001080">console</span><span style="color: #000000">.</span><span style="color: #795E26">log</span><span style="color: #000000">(</span><span style="color: #A31515">`Worker connected!`</span><span style="color: #000000">))</span>
<span style="color: #001080">zbWorker</span><span style="color: #000000">.</span><span style="color: #795E26">on</span><span style="color: #000000">(</span><span style="color: #A31515">&#039;connectionError&#039;</span><span style="color: #000000">, () </span><span style="color: #0000FF">=&gt;</span><span style="color: #000000"> </span><span style="color: #001080">console</span><span style="color: #000000">.</span><span style="color: #795E26">log</span><span style="color: #000000">(</span><span style="color: #A31515">`Worker disconnected!`</span><span style="color: #000000">))</span>
</code></pre>
				<p><a href = "initial-connection-tolerance" ></a></p>
				<a href="#initial-connection-tolerance" id="initial-connection-tolerance" style="color: inherit; text-decoration: none;">
					<h3>Initial Connection Tolerance</h3>
				</a>
				<p>Some broker connections can initially emit error messages - for example: when connecting to Camunda SaaS, during TLS negotiation and OAuth authentication, the eager commands used to detect connection status will fail, and the library will report connection errors.</p>
				<p>Since this is expected behaviour - a <em>characteristic of that particular connection</em> - the library has a configurable &quot;<em>initial connection tolerance</em>&quot;. This is a number of milliseconds representing the expected window in which these errors will occur on initial connection.</p>
				<p>If the library detects that you are connecting to Camunda SaaS, it sets this window to five seconds (5000 milliseconds). In some environments and under some conditions this may not be sufficient.</p>
				<p>You can set an explicit value for this using the environment variable <code>ZEEBE_INITIAL_CONNECTION_TOLERANCE</code>, set to a number of milliseconds.</p>
				<p>The effect of this setting is to suppress connection errors during this window, and only report them if the connection did not succeed by the end of the window.</p>
				<a href="#connecting-to-a-broker" id="connecting-to-a-broker" style="color: inherit; text-decoration: none;">
					<h2>Connecting to a Broker</h2>
				</a>
				<p><a name = "tls"></a></p>
				<a href="#tls" id="tls" style="color: inherit; text-decoration: none;">
					<h3>TLS</h3>
				</a>
				<p>The Node client does not use TLS by default.</p>
				<p>Enable a secure connection by setting <code>useTLS: true</code>:</p>
				<pre><code class="language-typescript"><span style="color: #0000FF">const</span><span style="color: #000000"> { </span><span style="color: #0070C1">ZBClient</span><span style="color: #000000"> } = </span><span style="color: #795E26">require</span><span style="color: #000000">(</span><span style="color: #A31515">&#039;zeebe-node&#039;</span><span style="color: #000000">)</span>

<span style="color: #0000FF">const</span><span style="color: #000000"> </span><span style="color: #0070C1">zbc</span><span style="color: #000000"> = </span><span style="color: #0000FF">new</span><span style="color: #000000"> </span><span style="color: #795E26">ZBClient</span><span style="color: #000000">(</span><span style="color: #001080">tlsSecuredGatewayAddress</span><span style="color: #000000">, {</span>
<span style="color: #000000">    </span><span style="color: #001080">useTLS:</span><span style="color: #000000"> </span><span style="color: #0000FF">true</span><span style="color: #000000">,</span>
<span style="color: #000000">})</span>
</code></pre>
				<p>Via environment variable:</p>
				<pre><code class="language-bash"><span style="color: #000000">ZEEBE_SECURE_CONNECTION=true</span>
</code></pre>
				<a href="#using-a-self-signed-certificate" id="using-a-self-signed-certificate" style="color: inherit; text-decoration: none;">
					<h3>Using a Self-signed Certificate</h3>
				</a>
				<p>You can use a self-signed SSL certificate with the Zeebe client. You need to provide the root certificates, the private key and the SSL cert chain as Buffers. You can pass them into the ZBClient constructor:</p>
				<pre><code class="language-typescript"><span style="color: #0000FF">const</span><span style="color: #000000"> </span><span style="color: #0070C1">rootCertsPath</span><span style="color: #000000"> = </span><span style="color: #A31515">&#039;/path/to/rootCerts&#039;</span>
<span style="color: #0000FF">const</span><span style="color: #000000"> </span><span style="color: #0070C1">privateKeyPath</span><span style="color: #000000"> = </span><span style="color: #A31515">&#039;/path/to/privateKey&#039;</span>
<span style="color: #0000FF">const</span><span style="color: #000000"> </span><span style="color: #0070C1">certChainPath</span><span style="color: #000000"> = </span><span style="color: #A31515">&#039;/path/to/certChain&#039;</span>

<span style="color: #0000FF">const</span><span style="color: #000000"> </span><span style="color: #0070C1">zbc</span><span style="color: #000000"> = </span><span style="color: #0000FF">new</span><span style="color: #000000"> </span><span style="color: #795E26">ZBClient</span><span style="color: #000000">({</span>
<span style="color: #000000">    </span><span style="color: #001080">useTLS:</span><span style="color: #000000"> </span><span style="color: #0000FF">true</span><span style="color: #000000">,</span>
<span style="color: #000000">    </span><span style="color: #001080">customSSL:</span><span style="color: #000000"> {</span>
<span style="color: #000000">        </span><span style="color: #001080">rootCerts:</span><span style="color: #000000"> </span><span style="color: #001080">rootCertsPath</span><span style="color: #000000">,</span>
<span style="color: #000000">        </span><span style="color: #001080">privateKey:</span><span style="color: #000000"> </span><span style="color: #001080">privateKeyPath</span><span style="color: #000000">,</span>
<span style="color: #000000">        </span><span style="color: #001080">certChain:</span><span style="color: #000000"> </span><span style="color: #001080">certChainPath</span>
<span style="color: #000000">    }</span>
<span style="color: #000000">})</span>

<span style="color: #001080">Or</span><span style="color: #000000"> </span><span style="color: #001080">you</span><span style="color: #000000"> </span><span style="color: #001080">can</span><span style="color: #000000"> </span><span style="color: #001080">put</span><span style="color: #000000"> </span><span style="color: #001080">the</span><span style="color: #000000"> </span><span style="color: #001080">file</span><span style="color: #000000"> </span><span style="color: #001080">paths</span><span style="color: #000000"> </span><span style="color: #001080">into</span><span style="color: #000000"> </span><span style="color: #001080">the</span><span style="color: #000000"> </span><span style="color: #001080">environment</span><span style="color: #000000"> </span><span style="color: #0000FF">in</span><span style="color: #000000"> </span><span style="color: #001080">the</span><span style="color: #000000"> </span><span style="color: #001080">following</span><span style="color: #000000"> variables:</span>

<span style="color: #0070C1">ZEEBE_CLIENT_SSL_ROOT_CERTS_PATH</span>
<span style="color: #0070C1">ZEEBE_CLIENT_SSL_PRIVATE_KEY_PATH</span>
<span style="color: #0070C1">ZEEBE_CLIENT_SSL_CERT_CHAIN_PATH</span>
</code></pre>
				<a href="#enable-tls" id="enable-tls" style="color: inherit; text-decoration: none;">
					<h1>Enable TLS</h1>
				</a>
				<pre><code><span style="color: #0070C1">ZEEBE_SECURE_CONNECTION</span><span style="color: #000000">=</span><span style="color: #0000FF">true</span>
</code></pre>
				<p>In this case, they will be passed to the constructor automatically.</p>
				<p><a name = "oauth"></a></p>
				<a href="#oauth" id="oauth" style="color: inherit; text-decoration: none;">
					<h3>OAuth</h3>
				</a>
				<p>In case you need to connect to a secured endpoint with OAuth, you can pass in OAuth credentials. This will enable TLS (unless you explicitly disable it with <code>useTLS: false</code>), and handle the OAuth flow to get / renew a JWT:</p>
				<pre><code class="language-typescript"><span style="color: #0000FF">const</span><span style="color: #000000"> { </span><span style="color: #0070C1">ZBClient</span><span style="color: #000000"> } = </span><span style="color: #795E26">require</span><span style="color: #000000">(</span><span style="color: #A31515">&#039;zeebe-node&#039;</span><span style="color: #000000">)</span>

<span style="color: #0000FF">const</span><span style="color: #000000"> </span><span style="color: #0070C1">zbc</span><span style="color: #000000"> = </span><span style="color: #0000FF">new</span><span style="color: #000000"> </span><span style="color: #795E26">ZBClient</span><span style="color: #000000">(</span><span style="color: #A31515">&quot;my-secure-broker.io:443&quot;</span><span style="color: #000000">, {</span>
<span style="color: #000000">    </span><span style="color: #001080">oAuth:</span><span style="color: #000000"> {</span>
<span style="color: #000000">        </span><span style="color: #001080">url:</span><span style="color: #000000"> </span><span style="color: #A31515">&quot;https://your-auth-endpoint/oauth/token&quot;</span><span style="color: #000000">,</span>
<span style="color: #000000">        </span><span style="color: #001080">audience:</span><span style="color: #000000"> </span><span style="color: #A31515">&quot;my-secure-broker.io&quot;</span><span style="color: #000000">,</span>
<span style="color: #000000">        </span><span style="color: #001080">scope:</span><span style="color: #000000"> </span><span style="color: #A31515">&quot;myScope&quot;</span><span style="color: #000000">,</span>
<span style="color: #000000">        </span><span style="color: #001080">clientId:</span><span style="color: #000000"> </span><span style="color: #A31515">&quot;myClientId&quot;</span><span style="color: #000000">,</span>
<span style="color: #000000">        </span><span style="color: #001080">clientSecret:</span><span style="color: #000000"> </span><span style="color: #A31515">&quot;randomClientSecret&quot;</span><span style="color: #000000">,</span>
<span style="color: #000000">        </span><span style="color: #001080">customRootCert:</span><span style="color: #000000"> </span><span style="color: #001080">fs</span><span style="color: #000000">.</span><span style="color: #795E26">readFileSync</span><span style="color: #000000">(</span><span style="color: #A31515">&#039;./my_CA.pem&#039;</span><span style="color: #000000">),</span>
<span style="color: #000000">        </span><span style="color: #001080">cacheOnDisk:</span><span style="color: #000000"> </span><span style="color: #0000FF">true</span>
<span style="color: #000000">    }</span>
<span style="color: #000000">}</span>
</code></pre>
				<p>The <code>cacheOnDisk</code> option will cache the token on disk in <code>$HOME/.camunda</code>, which can be useful in development if you are restarting the service frequently, or are running in a serverless environment, like AWS Lambda.</p>
				<p>If the cache directory is not writable, the ZBClient constructor will throw an exception. This is considered fatal, as it can lead to denial of service or hefty bills if you think caching is on when it is not.</p>
				<p>The <code>customRootCert</code> argument is optional. It can be used to provide a custom TLS certificate as a Buffer, which will be used while obtaining the OAuth token from the specified URL. If not provided, the CAs provided by <a href="https://ccadb-public.secure.force.com/mozilla/IncludedCACertificateReport">Mozilla</a> will be used.</p>
				<p><a name = "basic-auth"></a></p>
				<a href="#basic-auth" id="basic-auth" style="color: inherit; text-decoration: none;">
					<h2>Basic Auth</h2>
				</a>
				<p>If you put a proxy in front of the broker with basic auth, you can pass in a username and password:</p>
				<pre><code class="language-typescript"><span style="color: #0000FF">const</span><span style="color: #000000"> { </span><span style="color: #0070C1">ZBClient</span><span style="color: #000000"> } = </span><span style="color: #795E26">require</span><span style="color: #000000">(</span><span style="color: #A31515">&#039;zeebe-node&#039;</span><span style="color: #000000">)</span>

<span style="color: #0000FF">const</span><span style="color: #000000"> </span><span style="color: #0070C1">zbc</span><span style="color: #000000"> = </span><span style="color: #0000FF">new</span><span style="color: #000000"> </span><span style="color: #795E26">ZBClient</span><span style="color: #000000">(</span><span style="color: #A31515">&quot;my-broker-with-basic-auth.io:443&quot;</span><span style="color: #000000">, {</span>
<span style="color: #000000">    </span><span style="color: #001080">basicAuth:</span><span style="color: #000000"> {</span>
<span style="color: #000000">        </span><span style="color: #001080">username:</span><span style="color: #000000"> </span><span style="color: #A31515">&quot;user1&quot;</span><span style="color: #000000">,</span>
<span style="color: #000000">        </span><span style="color: #001080">password:</span><span style="color: #000000"> </span><span style="color: #A31515">&quot;secret&quot;</span><span style="color: #000000">,</span>
<span style="color: #000000">    },</span>
<span style="color: #000000">    </span><span style="color: #001080">useTLS:</span><span style="color: #000000"> </span><span style="color: #0000FF">true</span>
<span style="color: #000000">}</span>
</code></pre>
				<p>Basic Auth will also work without TLS.</p>
				<p><a name = "camunda-cloud"></a></p>
				<a href="#camunda-8-saas" id="camunda-8-saas" style="color: inherit; text-decoration: none;">
					<h3>Camunda 8 SaaS</h3>
				</a>
				<p><a href="https://camunda.io">Camunda 8 SaaS</a> is a hosted SaaS instance of Zeebe. The easiest way to connect is to use the <a href="#zero-conf">Zero-conf constructor</a> with the Client Credentials from the Camunda SaaS console as environment variables.</p>
				<p>You can also connect to Camunda SaaS by using the <code>camundaCloud</code> configuration option, using the <code>clusterId</code>, <code>clientSecret</code>, and <code>clientId</code> from the Camunda SaaS Console, like this:</p>
				<pre><code class="language-typescript"><span style="color: #0000FF">const</span><span style="color: #000000"> { </span><span style="color: #0070C1">ZBClient</span><span style="color: #000000"> } = </span><span style="color: #795E26">require</span><span style="color: #000000">(</span><span style="color: #A31515">&#039;zeebe-node&#039;</span><span style="color: #000000">)</span>

<span style="color: #0000FF">const</span><span style="color: #000000"> </span><span style="color: #0070C1">zbc</span><span style="color: #000000"> = </span><span style="color: #0000FF">new</span><span style="color: #000000"> </span><span style="color: #795E26">ZBClient</span><span style="color: #000000">({</span>
<span style="color: #000000">    </span><span style="color: #001080">camundaCloud:</span><span style="color: #000000"> {</span>
<span style="color: #000000">        </span><span style="color: #001080">clientId</span><span style="color: #000000">,</span>
<span style="color: #000000">        </span><span style="color: #001080">clientSecret</span><span style="color: #000000">,</span>
<span style="color: #000000">        </span><span style="color: #001080">clusterId</span><span style="color: #000000">,</span>
<span style="color: #000000">        </span><span style="color: #001080">clusterRegion</span><span style="color: #000000">, </span><span style="color: #008000">// optional, defaults to bru-2</span>
<span style="color: #000000">    },</span>
<span style="color: #000000">})</span>
</code></pre>
				<p>That&#39;s it! Under the hood, the client lib will construct the OAuth configuration for Camunda SaaS and set the gateway address and port for you.</p>
				<p>We recommend the <a href="#zero-conf">Zero-conf constructor</a> with the configuration passed in via environment variables. This allows you to run your application against different environments via configuration.</p>
				<p><a name = "zero-conf"></a></p>
				<a href="#zero-conf-constructor" id="zero-conf-constructor" style="color: inherit; text-decoration: none;">
					<h2>Zero-Conf constructor</h2>
				</a>
				<p>The ZBClient has a 0-parameter constructor that takes the config from the environment. This is useful for injecting secrets into your app via the environment, and switching between development and production environments with no change to code.</p>
				<p>To use the zero-conf constructor, you create the client like this:</p>
				<pre><code class="language-typescript"><span style="color: #0000FF">const</span><span style="color: #000000"> { </span><span style="color: #0070C1">ZBClient</span><span style="color: #000000"> } = </span><span style="color: #795E26">require</span><span style="color: #000000">(</span><span style="color: #A31515">&#039;zeebe-node&#039;</span><span style="color: #000000">)</span>

<span style="color: #0000FF">const</span><span style="color: #000000"> </span><span style="color: #0070C1">zbc</span><span style="color: #000000"> = </span><span style="color: #0000FF">new</span><span style="color: #000000"> </span><span style="color: #795E26">ZBClient</span><span style="color: #000000">()</span>
</code></pre>
				<p>With no relevant environment variables set, it will default to localhost on the default port with no TLS.</p>
				<p>The following environment variable configurations are possible with the Zero-conf constructor:</p>
				<p>From 8.3.0, multi-tenancy: </p>
				<pre><code class="language-bash"><span style="color: #000000">ZEEBE_TENANT_ID</span>
</code></pre>
				<p>Camunda SaaS:</p>
				<pre><code class="language-bash"><span style="color: #000000">ZEEBE_ADDRESS</span>
<span style="color: #000000">ZEEBE_CLIENT_SECRET</span>
<span style="color: #000000">ZEEBE_CLIENT_ID</span>
<span style="color: #000000">ZEEBE_TOKEN_AUDIENCE</span>
<span style="color: #000000">ZEEBE_AUTHORIZATION_SERVER_URL</span>
</code></pre>
				<p>Self-hosted or local broker (no TLS or OAuth):</p>
				<pre><code class="language-bash"><span style="color: #000000">ZEEBE_ADDRESS</span>
</code></pre>
				<p>Self-hosted with self-signed SSL certificate:</p>
				<pre><code class="language-bash"><span style="color: #000000">ZEEBE_CLIENT_SSL_ROOT_CERTS_PATH</span>
<span style="color: #000000">ZEEBE_CLIENT_SSL_PRIVATE_KEY_PATH</span>
<span style="color: #000000">ZEEBE_CLIENT_SSL_CERT_CHAIN_PATH</span>
<span style="color: #000000">ZEEBE_SECURE_CONNECTION=true</span>
</code></pre>
				<p>Self-hosted or local broker with OAuth + TLS:</p>
				<pre><code class="language-bash"><span style="color: #000000">ZEEBE_CLIENT_ID</span>
<span style="color: #000000">ZEEBE_CLIENT_SECRET</span>
<span style="color: #000000">ZEEBE_TOKEN_AUDIENCE</span>
<span style="color: #000000">ZEEBE_TOKEN_SCOPE</span>
<span style="color: #000000">ZEEBE_AUTHORIZATION_SERVER_URL</span>
<span style="color: #000000">ZEEBE_ADDRESS</span>
</code></pre>
				<p>Multi-tenant self-hosted or local broker with OAuth and no TLS:</p>
				<pre><code class="language-bash"><span style="color: #000000">ZEEBE_TENANT_ID=</span><span style="color: #A31515">&#039;&lt;default&gt;&#039;</span>
<span style="color: #000000">ZEEBE_SECURE_CONNECTION=false</span>
<span style="color: #000000">ZEEBE_ADDRESS=</span><span style="color: #A31515">&#039;localhost:26500&#039;</span>
<span style="color: #000000">ZEEBE_CLIENT_ID=</span><span style="color: #A31515">&#039;zeebe&#039;</span>
<span style="color: #000000">ZEEBE_CLIENT_SECRET=</span><span style="color: #A31515">&#039;zecret&#039;</span>
<span style="color: #000000">ZEEBE_AUTHORIZATION_SERVER_URL=</span><span style="color: #A31515">&#039;http://localhost:18080/auth/realms/camunda-platform/protocol/openid-connect/token&#039;</span>
<span style="color: #000000">ZEEBE_TOKEN_AUDIENCE=</span><span style="color: #A31515">&#039;zeebe.camunda.io&#039;</span>
<span style="color: #000000">ZEEBE_TOKEN_SCOPE=</span><span style="color: #A31515">&#039;not needed&#039;</span>
<span style="color: #000000">CAMUNDA_CREDENTIALS_SCOPES=</span><span style="color: #A31515">&#039;Zeebe&#039;</span>
<span style="color: #000000">CAMUNDA_OAUTH_URL=</span><span style="color: #A31515">&#039;http://localhost:18080/auth/realms/camunda-platform/protocol/openid-connect/token&#039;</span>
</code></pre>
				<p>Basic Auth:</p>
				<pre><code class="language-bash"><span style="color: #000000">ZEEBE_BASIC_AUTH_PASSWORD</span>
<span style="color: #000000">ZEEBE_BASIC_AUTH_USERNAME</span>
</code></pre>
				<p><a name ="job-workers"></a></p>
				<a href="#job-workers" id="job-workers" style="color: inherit; text-decoration: none;">
					<h2>Job Workers</h2>
				</a>
				<a href="#types-of-job-workers" id="types-of-job-workers" style="color: inherit; text-decoration: none;">
					<h3>Types of Job Workers</h3>
				</a>
				<p>There are two different types of job worker provided by the Zeebe Node client:</p>
				<ul>
					<li>The <code>ZBWorker</code> - this worker operates on individual jobs.</li>
					<li>The <code>ZBBatchWorker</code> - this worker batches jobs on the client, to allow you to batch operations that pool resources. (<em>This worker was introduced in 0.23.0 of the client</em>).</li>
				</ul>
				<p>Much of the information in the following <a href="#create-zbworker"><code>ZBWorker</code> section</a> applies also to the <code>ZBBatchWorker</code>. The <code>ZBBatchWorker</code> section covers the features that differ from the <code>ZBWorker</code>.</p>
				<p><a name = "create-zbworker"></a></p>
				<a href="#the-zbworker-job-worker" id="the-zbworker-job-worker" style="color: inherit; text-decoration: none;">
					<h3>The <code>ZBWorker</code> Job Worker</h3>
				</a>
				<p>The <code>ZBWorker</code> takes a <em>job handler function</em> that is invoked for each job. It is invoked as soon as the worker retrieves a job from the broker. The worker can retrieve any number of jobs in a response from the broker, and the handler is invoked for each one, independently.</p>
				<p>The simplest signature for a worker takes a string task type, and a job handler function.</p>
				<p>The job handler receives the job object, which has methods that it can use to complete or fail the job, and a reference to the worker itself, which you can use to log using the worker&#39;s configured logger (See <a href="#logging">Logging</a>).</p>
				<p>Note: <em>The second argument is deprecated, and remains for backward-compatibility - it is a complete function. In the 1.0 version of the API, the complete function methods are available on the <code>job</code> object</em>.</p>
				<pre><code class="language-javascript"><span style="color: #0000FF">const</span><span style="color: #000000"> </span><span style="color: #0070C1">ZB</span><span style="color: #000000"> = </span><span style="color: #795E26">require</span><span style="color: #000000">(</span><span style="color: #A31515">&#039;zeebe-node&#039;</span><span style="color: #000000">)</span>

<span style="color: #0000FF">const</span><span style="color: #000000"> </span><span style="color: #0070C1">zbc</span><span style="color: #000000"> = </span><span style="color: #0000FF">new</span><span style="color: #000000"> </span><span style="color: #0070C1">ZB</span><span style="color: #000000">.</span><span style="color: #795E26">ZBClient</span><span style="color: #000000">()</span>

<span style="color: #0000FF">const</span><span style="color: #000000"> </span><span style="color: #0070C1">zbWorker</span><span style="color: #000000"> = </span><span style="color: #001080">zbc</span><span style="color: #000000">.</span><span style="color: #795E26">createWorker</span><span style="color: #000000">({</span>
<span style="color: #000000">    </span><span style="color: #001080">taskType:</span><span style="color: #000000"> </span><span style="color: #A31515">&#039;demo-service&#039;</span><span style="color: #000000">,</span>
<span style="color: #000000">    </span><span style="color: #001080">taskHandler:</span><span style="color: #000000"> </span><span style="color: #001080">handler</span><span style="color: #000000">,</span>
<span style="color: #000000">})</span>

<span style="color: #0000FF">function</span><span style="color: #000000"> </span><span style="color: #795E26">handler</span><span style="color: #000000">(</span><span style="color: #001080">job</span><span style="color: #000000">) {</span>
<span style="color: #000000">    </span><span style="color: #001080">zbWorker</span><span style="color: #000000">.</span><span style="color: #795E26">log</span><span style="color: #000000">(</span><span style="color: #A31515">&#039;Task variables&#039;</span><span style="color: #000000">, </span><span style="color: #001080">job</span><span style="color: #000000">.</span><span style="color: #001080">variables</span><span style="color: #000000">)</span>

<span style="color: #000000">    </span><span style="color: #008000">// Task worker business logic goes here</span>
<span style="color: #000000">    </span><span style="color: #0000FF">const</span><span style="color: #000000"> </span><span style="color: #0070C1">updateToBrokerVariables</span><span style="color: #000000"> = {</span>
<span style="color: #000000">        </span><span style="color: #001080">updatedProperty:</span><span style="color: #000000"> </span><span style="color: #A31515">&#039;newValue&#039;</span><span style="color: #000000">,</span>
<span style="color: #000000">    }</span>

<span style="color: #000000">    </span><span style="color: #AF00DB">return</span><span style="color: #000000"> </span><span style="color: #001080">job</span><span style="color: #000000">.</span><span style="color: #795E26">complete</span><span style="color: #000000">(</span><span style="color: #001080">updateToBrokerVariables</span><span style="color: #000000">)</span>
<span style="color: #000000">}</span>
</code></pre>
				<p>Here is an example job:</p>
				<pre><code class="language-javascript">
<span style="color: #000000">{ key: </span><span style="color: #A31515">&#039;578&#039;</span><span style="color: #000000">,</span>
<span style="color: #000000">  type: </span><span style="color: #A31515">&#039;demo-service&#039;</span><span style="color: #000000">,</span>
<span style="color: #000000">  jobHeaders:</span>
<span style="color: #000000">   { processInstanceKey: </span><span style="color: #A31515">&#039;574&#039;</span><span style="color: #000000">,</span>
<span style="color: #000000">     bpmnProcessId: </span><span style="color: #A31515">&#039;test-process&#039;</span><span style="color: #000000">,</span>
<span style="color: #000000">     processDefinitionVersion: </span><span style="color: #098658">1</span><span style="color: #000000">,</span>
<span style="color: #000000">     processKey: </span><span style="color: #A31515">&#039;3&#039;</span><span style="color: #000000">,</span>
<span style="color: #000000">     elementId: </span><span style="color: #A31515">&#039;ServiceTask_0xdwuw7&#039;</span><span style="color: #000000">,</span>
<span style="color: #000000">     elementInstanceKey: </span><span style="color: #A31515">&#039;577&#039;</span><span style="color: #000000"> },</span>
<span style="color: #000000">  customHeaders: </span><span style="color: #A31515">&#039;{}&#039;</span><span style="color: #000000">,</span>
<span style="color: #000000">  worker: </span><span style="color: #A31515">&#039;test-worker&#039;</span><span style="color: #000000">,</span>
<span style="color: #000000">  retries: </span><span style="color: #098658">3</span><span style="color: #000000">,</span>
<span style="color: #000000">  deadline: </span><span style="color: #A31515">&#039;1546915422636&#039;</span><span style="color: #000000">,</span>
<span style="color: #000000">  variables: { testData: </span><span style="color: #A31515">&#039;something&#039;</span><span style="color: #000000"> } }</span>
</code></pre>
				<p>The worker can be configured with options. To do this, you should use the object parameter constructor.</p>
				<p>Shown below are the defaults that apply if you don&#39;t supply them:</p>
				<pre><code class="language-javascript"><span style="color: #0000FF">const</span><span style="color: #000000"> { </span><span style="color: #0070C1">ZBClient</span><span style="color: #000000">, </span><span style="color: #0070C1">Duration</span><span style="color: #000000"> } = </span><span style="color: #795E26">require</span><span style="color: #000000">(</span><span style="color: #A31515">&#039;zeebe-node&#039;</span><span style="color: #000000">)</span>

<span style="color: #0000FF">const</span><span style="color: #000000"> </span><span style="color: #0070C1">zbc</span><span style="color: #000000"> = </span><span style="color: #0000FF">new</span><span style="color: #000000"> </span><span style="color: #795E26">ZBClient</span><span style="color: #000000">()</span>

<span style="color: #0000FF">const</span><span style="color: #000000"> </span><span style="color: #0070C1">zbWorker</span><span style="color: #000000"> = </span><span style="color: #001080">zbc</span><span style="color: #000000">.</span><span style="color: #795E26">createWorker</span><span style="color: #000000">({</span>
<span style="color: #000000">    </span><span style="color: #001080">taskType:</span><span style="color: #000000"> </span><span style="color: #A31515">&#039;demo-service&#039;</span><span style="color: #000000">,</span>
<span style="color: #000000">    </span><span style="color: #001080">taskHandler:</span><span style="color: #000000"> </span><span style="color: #001080">handler</span><span style="color: #000000">,</span>
<span style="color: #000000">    </span><span style="color: #008000">// the number of simultaneous tasks this worker can handle</span>
<span style="color: #000000">    </span><span style="color: #001080">maxJobsToActivate:</span><span style="color: #000000"> </span><span style="color: #098658">32</span><span style="color: #000000">,</span>
<span style="color: #000000">    </span><span style="color: #008000">// the amount of time the broker should allow this worker to complete a task</span>
<span style="color: #000000">    </span><span style="color: #001080">timeout:</span><span style="color: #000000"> </span><span style="color: #001080">Duration</span><span style="color: #000000">.</span><span style="color: #001080">seconds</span><span style="color: #000000">.</span><span style="color: #795E26">of</span><span style="color: #000000">(</span><span style="color: #098658">30</span><span style="color: #000000">),</span>
<span style="color: #000000">    </span><span style="color: #008000">// One of &#039;DEBUG&#039;, &#039;INFO&#039;, &#039;NONE&#039;</span>
<span style="color: #000000">    </span><span style="color: #001080">loglevel:</span><span style="color: #000000"> </span><span style="color: #A31515">&#039;INFO&#039;</span><span style="color: #000000">,</span>
<span style="color: #000000">    </span><span style="color: #008000">// Called when the connection to the broker cannot be established, or fails</span>
<span style="color: #000000">    </span><span style="color: #795E26">onConnectionError</span><span style="color: #001080">:</span><span style="color: #000000"> () </span><span style="color: #0000FF">=&gt;</span><span style="color: #000000"> </span><span style="color: #001080">zbWorker</span><span style="color: #000000">.</span><span style="color: #795E26">log</span><span style="color: #000000">(</span><span style="color: #A31515">&#039;Disconnected&#039;</span><span style="color: #000000">)</span>
<span style="color: #000000">    </span><span style="color: #008000">// Called when the connection to the broker is (re-)established</span>
<span style="color: #000000">    </span><span style="color: #001080">onReady</span><span style="color: #000000">: () </span><span style="color: #0000FF">=&gt;</span><span style="color: #000000"> </span><span style="color: #001080">zbWorker</span><span style="color: #000000">.</span><span style="color: #795E26">log</span><span style="color: #000000">(</span><span style="color: #A31515">&#039;Connected.&#039;</span><span style="color: #000000">)</span>
<span style="color: #000000">})</span>
</code></pre>
				<p><a name = "unhandled-exceptions"></a></p>
				<a href="#unhandled-exceptions-in-task-handlers" id="unhandled-exceptions-in-task-handlers" style="color: inherit; text-decoration: none;">
					<h4>Unhandled Exceptions in Task Handlers</h4>
				</a>
				<p><em>Note: this behaviour is for the ZBWorker only. The ZBBatchWorker does not manage this.</em></p>
				<p>When a task handler throws an unhandled exception, the library will fail the job. Zeebe will then retry the job according to the retry settings of the task. Sometimes you want to halt the entire process so you can investigate. To have the library cancel the process on an unhandled exception, pass in <code>{failProcessOnException: true}</code> to the <code>createWorker</code> call:</p>
				<pre><code class="language-typescript"><span style="color: #AF00DB">import</span><span style="color: #000000"> { </span><span style="color: #001080">ZBClient</span><span style="color: #000000"> } </span><span style="color: #AF00DB">from</span><span style="color: #000000"> </span><span style="color: #A31515">&#039;zeebe-node&#039;</span>

<span style="color: #0000FF">const</span><span style="color: #000000"> </span><span style="color: #0070C1">zbc</span><span style="color: #000000"> = </span><span style="color: #0000FF">new</span><span style="color: #000000"> </span><span style="color: #795E26">ZBClient</span><span style="color: #000000">()</span>

<span style="color: #001080">zbc</span><span style="color: #000000">.</span><span style="color: #795E26">createWorker</span><span style="color: #000000">({</span>
<span style="color: #000000">    </span><span style="color: #001080">taskType:</span><span style="color: #000000"> </span><span style="color: #A31515">&#039;console-log&#039;</span><span style="color: #000000">,</span>
<span style="color: #000000">    </span><span style="color: #001080">taskHandler:</span><span style="color: #000000"> </span><span style="color: #001080">maybeFaultyHandler</span><span style="color: #000000">,</span>
<span style="color: #000000">    </span><span style="color: #001080">failProcessOnException:</span><span style="color: #000000"> </span><span style="color: #0000FF">true</span><span style="color: #000000">,</span>
<span style="color: #000000">})</span>
</code></pre>
				<p><a name = "complete-tasks"></a></p>
				<a href="#completing-tasks-with-success-failure-error-or-forwarded" id="completing-tasks-with-success-failure-error-or-forwarded" style="color: inherit; text-decoration: none;">
					<h3>Completing tasks with success, failure, error, or forwarded</h3>
				</a>
				<p>To complete a task, the job object that the task worker handler function receives has <code>complete</code>, <code>fail</code>, and <code>error</code> methods.</p>
				<p>Call <code>job.complete()</code> passing in a optional plain old JavaScript object (POJO) - a key:value map. These are variable:value pairs that will be used to update the process state in the broker. They will be merged with existing values. You can set an existing key to <code>null</code> or <code>undefined</code>, but there is no way to delete a key.</p>
				<p>Call <code>job.fail()</code> to fail the task. You mus t pass in a string message describing the failure. The client library decrements the retry count, and the broker handles the retry logic. If the failure is a hard failure and should cause an incident to be raised in Operate, then pass in <code>0</code> for the optional second parameter, <code>retries</code>:</p>
				<pre><code class="language-javascript"><span style="color: #001080">job</span><span style="color: #000000">.</span><span style="color: #795E26">fail</span><span style="color: #000000">(</span><span style="color: #A31515">&#039;This is a critical failure and will raise an incident&#039;</span><span style="color: #000000">, </span><span style="color: #098658">0</span><span style="color: #000000">)</span>
</code></pre>
				<p>From version 8.0.0 of the package, used with a 8.0.0 Zeebe broker, you can specify to the broker an optional backoff for the reactivation of the job, like this:</p>
				<pre><code class="language-javascript"><span style="color: #001080">job</span><span style="color: #000000">.</span><span style="color: #795E26">fail</span><span style="color: #000000">({</span>
<span style="color: #000000">    </span><span style="color: #001080">errorMessage:</span><span style="color: #000000"> </span><span style="color: #A31515">&#039;Triggering a retry with a two second back-off&#039;</span><span style="color: #000000">,</span>
<span style="color: #000000">    </span><span style="color: #001080">retryBackOff:</span><span style="color: #000000"> </span><span style="color: #098658">2000</span><span style="color: #000000">,</span>
<span style="color: #000000">    </span><span style="color: #001080">retries:</span><span style="color: #000000"> </span><span style="color: #098658">1</span><span style="color: #000000">,</span>
<span style="color: #000000">})</span>
</code></pre>
				<p>Call <code>job.error()</code> to trigger a BPMN error throw event. You must pass in a string error code for the error code, and you can pass an optional error message as the second parameter. If no BPMN error catch event exists for the error code, an incident will be raised.</p>
				<pre><code class="language-javascript"><span style="color: #001080">job</span><span style="color: #000000">.</span><span style="color: #795E26">error</span><span style="color: #000000">(</span><span style="color: #A31515">&#039;RECORD_NOT_FOUND&#039;</span><span style="color: #000000">, </span><span style="color: #A31515">&#039;Could not find the customer in the database&#039;</span><span style="color: #000000">)</span>
</code></pre>
				<p>From 8.2.5 of the client, you can update the variables in the workflow when you throw a BPMN error in a worker:</p>
				<pre><code class="language-javascript"><span style="color: #001080">job</span><span style="color: #000000">.</span><span style="color: #795E26">error</span><span style="color: #000000">({</span>
<span style="color: #000000">    </span><span style="color: #001080">errorCode:</span><span style="color: #000000"> </span><span style="color: #A31515">&#039;RECORD_NOT_FOUND&#039;</span><span style="color: #000000">,</span>
<span style="color: #000000">    </span><span style="color: #001080">errorMessage:</span><span style="color: #000000"> </span><span style="color: #A31515">&#039;Could not find the customer in the database&#039;</span><span style="color: #000000">,</span>
<span style="color: #000000">    </span><span style="color: #001080">variables:</span><span style="color: #000000"> {</span>
<span style="color: #000000">        </span><span style="color: #001080">someVariable:</span><span style="color: #000000"> </span><span style="color: #A31515">&#039;someValue&#039;</span>
<span style="color: #000000">    }</span>
<span style="color: #000000">})</span>
</code></pre>
				<p>Call <code>job.forwarded()</code> to release worker capacity to handle another job, without completing the job in any way with the Zeebe broker. This method supports the <em>decoupled job completion</em> pattern. In this pattern, the worker forwards the job to another system - a lambda or a RabbitMQ queue. Some other process is ultimately responsible for completing the job.</p>
				<p><a name = "working-with-variables"></a></p>
				<a href="#working-with-process-variables-and-custom-headers" id="working-with-process-variables-and-custom-headers" style="color: inherit; text-decoration: none;">
					<h2>Working with Process Variables and Custom Headers</h2>
				</a>
				<p>Process variables are available in your worker job handler callback as <code>job.variables</code>, and any custom headers are available as <code>job.customHeaders</code>.</p>
				<p>These are read-only JavaScript objects in the Zeebe Node client. However, they are not stored that way in the broker.</p>
				<p>Both process variables and custom headers are stored in the broker as a dictionary of named strings. That means that the variables and custom headers are JSON.parsed in the Node client when it fetches the job, and any update passed to the <code>success()</code> function is JSON.stringified.</p>
				<p>If you pass in a circular JSON structure to <code>complete()</code> - like, for example the response object from an HTTP call - it will throw, as this cannot be serialised to a string.</p>
				<p>To update a key deep in the object structure of a process variable, you can use the <a href="https://www.npmjs.com/package/deepmerge">deepmerge utility</a>:</p>
				<pre><code class="language-TypeScript"><span style="color: #0000FF">const</span><span style="color: #000000"> </span><span style="color: #0070C1">merge</span><span style="color: #000000"> = </span><span style="color: #795E26">require</span><span style="color: #000000">(</span><span style="color: #A31515">&#039;deepmerge&#039;</span><span style="color: #000000">)</span>
<span style="color: #AF00DB">import</span><span style="color: #000000"> { </span><span style="color: #001080">ZBClient</span><span style="color: #000000"> } </span><span style="color: #AF00DB">from</span><span style="color: #000000"> </span><span style="color: #A31515">&#039;zeebe-node&#039;</span>

<span style="color: #0000FF">const</span><span style="color: #000000"> </span><span style="color: #0070C1">zbc</span><span style="color: #000000"> = </span><span style="color: #0000FF">new</span><span style="color: #000000"> </span><span style="color: #795E26">ZBClient</span><span style="color: #000000">()</span>

<span style="color: #001080">zbc</span><span style="color: #000000">.</span><span style="color: #795E26">createWorker</span><span style="color: #000000">({</span>
<span style="color: #000000">    </span><span style="color: #001080">taskType:</span><span style="color: #000000"> </span><span style="color: #A31515">&#039;some-task&#039;</span><span style="color: #000000">,</span>
<span style="color: #000000">    </span><span style="color: #795E26">taskHandler</span><span style="color: #001080">:</span><span style="color: #000000"> </span><span style="color: #001080">job</span><span style="color: #000000"> </span><span style="color: #0000FF">=&gt;</span><span style="color: #000000"> {</span>
<span style="color: #000000">        </span><span style="color: #0000FF">const</span><span style="color: #000000"> { </span><span style="color: #0070C1">people</span><span style="color: #000000"> } = </span><span style="color: #001080">job</span><span style="color: #000000">.</span><span style="color: #001080">variables</span>
<span style="color: #000000">        </span><span style="color: #008000">// update bob&#039;s age, keeping all his other properties the same</span>
<span style="color: #000000">        </span><span style="color: #001080">job</span><span style="color: #000000">.</span><span style="color: #795E26">complete</span><span style="color: #000000">(</span><span style="color: #795E26">merge</span><span style="color: #000000">(</span><span style="color: #001080">people</span><span style="color: #000000">, { </span><span style="color: #001080">bob:</span><span style="color: #000000"> { </span><span style="color: #001080">age:</span><span style="color: #000000"> </span><span style="color: #098658">23</span><span style="color: #000000"> } }))</span>
<span style="color: #000000">    }</span>
<span style="color: #000000">})</span>
</code></pre>
				<p>When setting custom headers in BPMN tasks, while designing your model, you can put stringified JSON as the value for a custom header, and it will show up in the client as a JavaScript object.</p>
				<p>Process variables and custom headers are untyped in the Zeebe broker, however the Node client in TypeScript mode provides the option to type them to provide safety. You can type your worker as <code>any</code> to turn that off:</p>
				<pre><code class="language-TypeScript"><span style="color: #008000">// No type checking - totally dynamic and unchecked</span>
<span style="color: #001080">zbc</span><span style="color: #000000">.</span><span style="color: #795E26">createWorker</span><span style="color: #000000">&lt;</span><span style="color: #267F99">any</span><span style="color: #000000">&gt;({</span>
<span style="color: #000000">    </span><span style="color: #001080">taskType:</span><span style="color: #000000"> </span><span style="color: #A31515">&#039;yolo-jobs&#039;</span><span style="color: #000000">,</span>
<span style="color: #000000">    </span><span style="color: #795E26">taskHandler</span><span style="color: #001080">:</span><span style="color: #000000"> (</span><span style="color: #001080">job</span><span style="color: #000000">) </span><span style="color: #0000FF">=&gt;</span><span style="color: #000000"> {</span>
<span style="color: #000000">        </span><span style="color: #001080">console</span><span style="color: #000000">.</span><span style="color: #795E26">log</span><span style="color: #000000">(</span><span style="color: #A31515">`Look ma - </span><span style="color: #0000FF">${</span><span style="color: #001080">job</span><span style="color: #000000FF">.</span><span style="color: #001080">variables</span><span style="color: #000000FF">?.</span><span style="color: #001080">anything</span><span style="color: #000000FF">?.</span><span style="color: #001080">goes</span><span style="color: #000000FF">?.</span><span style="color: #795E26">toUpperCase</span><span style="color: #000000FF">()</span><span style="color: #0000FF">}</span><span style="color: #A31515">`</span><span style="color: #000000">)</span>
<span style="color: #000000">        </span><span style="color: #001080">job</span><span style="color: #000000">.</span><span style="color: #795E26">complete</span><span style="color: #000000">({</span><span style="color: #001080">what:</span><span style="color: #000000"> </span><span style="color: #001080">job</span><span style="color: #000000">.</span><span style="color: #001080">variables</span><span style="color: #000000">.</span><span style="color: #001080">could</span><span style="color: #000000">.</span><span style="color: #001080">possibly</span><span style="color: #000000">.</span><span style="color: #001080">go</span><span style="color: #000000">.</span><span style="color: #001080">wrong</span><span style="color: #000000">})</span>
<span style="color: #000000">    }</span>
<span style="color: #000000">})</span>
</code></pre>
				<p>See the section <a href="#strongly-typed">Writing Strongly-typed Job Workers</a> for more details.</p>
				<p><a name = "fetch-variables"></a></p>
				<a href="#constraining-the-variables-fetched-by-the-worker" id="constraining-the-variables-fetched-by-the-worker" style="color: inherit; text-decoration: none;">
					<h2>Constraining the Variables Fetched by the Worker</h2>
				</a>
				<p>Sometimes you only need a few specific process variables to service a job. One way you can achieve constraint on the process variables received by a worker is by using <a href="https://docs.zeebe.io/reference/variables.html#inputoutput-variable-mappings">input variable mappings</a> on the task in the model.</p>
				<p>You can also use the <code>fetchVariable</code> parameter when creating a worker. Pass an array of strings, containing the names of the variables to fetch, to the <code>fetchVariable</code> parameter when creating a worker. Here is an example, in JavaScript:</p>
				<pre><code class="language-javascript"><span style="color: #001080">zbc</span><span style="color: #000000">.</span><span style="color: #795E26">createWorker</span><span style="color: #000000">({</span>
<span style="color: #000000">    </span><span style="color: #001080">taskType:</span><span style="color: #000000"> </span><span style="color: #A31515">&#039;process-favorite-albums&#039;</span><span style="color: #000000">,</span>
<span style="color: #000000">    </span><span style="color: #795E26">taskHandler</span><span style="color: #001080">:</span><span style="color: #000000"> </span><span style="color: #001080">job</span><span style="color: #000000"> </span><span style="color: #0000FF">=&gt;</span><span style="color: #000000"> {</span>
<span style="color: #000000">        </span><span style="color: #0000FF">const</span><span style="color: #000000"> { </span><span style="color: #0070C1">name</span><span style="color: #000000">, </span><span style="color: #0070C1">albums</span><span style="color: #000000"> } = </span><span style="color: #001080">job</span><span style="color: #000000">.</span><span style="color: #001080">variables</span>
<span style="color: #000000">        </span><span style="color: #001080">console</span><span style="color: #000000">.</span><span style="color: #795E26">log</span><span style="color: #000000">(</span><span style="color: #A31515">`</span><span style="color: #0000FF">${</span><span style="color: #001080">name</span><span style="color: #0000FF">}</span><span style="color: #A31515"> has the following albums: </span><span style="color: #0000FF">${</span><span style="color: #001080">albums</span><span style="color: #000000FF">.</span><span style="color: #795E26">join</span><span style="color: #000000FF">(</span><span style="color: #A31515">&#039;, &#039;</span><span style="color: #000000FF">)</span><span style="color: #0000FF">}</span><span style="color: #A31515">`</span><span style="color: #000000">)</span>
<span style="color: #000000">        </span><span style="color: #001080">job</span><span style="color: #000000">.</span><span style="color: #795E26">complete</span><span style="color: #000000">()</span>
<span style="color: #000000">    },</span>
<span style="color: #000000">    </span><span style="color: #001080">fetchVariable:</span><span style="color: #000000"> [</span><span style="color: #A31515">&#039;name&#039;</span><span style="color: #000000">, </span><span style="color: #A31515">&#039;albums&#039;</span><span style="color: #000000">],</span>
<span style="color: #000000">})</span>
</code></pre>
				<p>If you are using TypeScript, you can supply an interface describing the process variables, and parameterize the worker:</p>
				<pre><code class="language-TypeScript"><span style="color: #0000FF">interface</span><span style="color: #000000"> </span><span style="color: #267F99">Variables</span><span style="color: #000000"> {</span>
<span style="color: #000000">    </span><span style="color: #001080">name</span><span style="color: #000000">: </span><span style="color: #267F99">string</span>
<span style="color: #000000">    </span><span style="color: #001080">albums</span><span style="color: #000000">: </span><span style="color: #267F99">string</span><span style="color: #000000">[]</span>
<span style="color: #000000">}</span>

<span style="color: #001080">zbc</span><span style="color: #000000">.</span><span style="color: #795E26">createWorker</span><span style="color: #000000">&lt;</span><span style="color: #267F99">Variables</span><span style="color: #000000">&gt;({</span>
<span style="color: #000000">    </span><span style="color: #001080">taskType:</span><span style="color: #000000"> </span><span style="color: #A31515">&#039;process-favorite-albums&#039;</span><span style="color: #000000">,</span>
<span style="color: #000000">    </span><span style="color: #795E26">taskHandler</span><span style="color: #001080">:</span><span style="color: #000000"> (</span><span style="color: #001080">job</span><span style="color: #000000">) </span><span style="color: #0000FF">=&gt;</span><span style="color: #000000"> {</span>
<span style="color: #000000">        </span><span style="color: #0000FF">const</span><span style="color: #000000"> { </span><span style="color: #0070C1">name</span><span style="color: #000000">, </span><span style="color: #0070C1">albums</span><span style="color: #000000"> = [] } = </span><span style="color: #001080">job</span><span style="color: #000000">.</span><span style="color: #001080">variables</span>
<span style="color: #000000">        </span><span style="color: #001080">console</span><span style="color: #000000">.</span><span style="color: #795E26">log</span><span style="color: #000000">(</span><span style="color: #A31515">`</span><span style="color: #0000FF">${</span><span style="color: #001080">name</span><span style="color: #0000FF">}</span><span style="color: #A31515"> has the following albums: </span><span style="color: #0000FF">${</span><span style="color: #001080">albums</span><span style="color: #000000FF">?.</span><span style="color: #795E26">join</span><span style="color: #000000FF">?.(</span><span style="color: #A31515">&#039;, &#039;</span><span style="color: #000000FF">)</span><span style="color: #0000FF">}</span><span style="color: #A31515">`</span><span style="color: #000000">)</span>
<span style="color: #000000">        </span><span style="color: #001080">job</span><span style="color: #000000">.</span><span style="color: #795E26">complete</span><span style="color: #000000">()</span>
<span style="color: #000000">    },</span>
<span style="color: #000000">    </span><span style="color: #001080">fetchVariable:</span><span style="color: #000000"> [</span><span style="color: #A31515">&#039;name&#039;</span><span style="color: #000000">, </span><span style="color: #A31515">&#039;albums&#039;</span><span style="color: #000000">],</span>
<span style="color: #000000">})</span>
</code></pre>
				<p>This parameterization does two things:</p>
				<ul>
					<li>It informs the worker about the expected types of the variables. For example, if <code>albums</code> is a string, calling <code>join</code> on it will fail at runtime. Providing the type allows the compiler to reason about the valid methods that can be applied to the variables.</li>
					<li>It allows the type-checker to pick up spelling errors in the strings in <code>fetchVariable</code>, by comparing them with the Variables typing.</li>
				</ul>
				<p>Note, that this does not protect you against run-time exceptions where your typings are incorrect, or the payload simply does not match the definition that you provided.</p>
				<p>See the section <a href="#strongly-typed"> Writing Strongly-typed Job Workers </a> for more details on run-time safety.</p>
				<p>You can turn off the type-safety by typing the worker as <code>any</code>:</p>
				<pre><code class="language-TypeScript"><span style="color: #001080">zbc</span><span style="color: #000000">.</span><span style="color: #795E26">createWorker</span><span style="color: #000000">&lt;</span><span style="color: #267F99">any</span><span style="color: #000000">&gt;({</span>
<span style="color: #000000">    </span><span style="color: #001080">taskType:</span><span style="color: #000000"> </span><span style="color: #A31515">&#039;process-favorite-albums&#039;</span><span style="color: #000000">,</span>
<span style="color: #000000">    </span><span style="color: #795E26">taskHandler</span><span style="color: #001080">:</span><span style="color: #000000"> (</span><span style="color: #001080">job</span><span style="color: #000000">) </span><span style="color: #0000FF">=&gt;</span><span style="color: #000000"> {</span>
<span style="color: #000000">        </span><span style="color: #0000FF">const</span><span style="color: #000000"> { </span><span style="color: #0070C1">name</span><span style="color: #000000">, </span><span style="color: #0070C1">albums</span><span style="color: #000000"> = [] } = </span><span style="color: #001080">job</span><span style="color: #000000">.</span><span style="color: #001080">variables</span>
<span style="color: #000000">        </span><span style="color: #008000">// TS 3.7 safe access to .join _and_ safe call, to prevent run-time exceptions</span>
<span style="color: #000000">        </span><span style="color: #001080">console</span><span style="color: #000000">.</span><span style="color: #795E26">log</span><span style="color: #000000">(</span><span style="color: #A31515">`</span><span style="color: #0000FF">${</span><span style="color: #001080">name</span><span style="color: #0000FF">}</span><span style="color: #A31515"> has the following albums: </span><span style="color: #0000FF">${</span><span style="color: #001080">albums</span><span style="color: #000000FF">?.</span><span style="color: #795E26">join</span><span style="color: #000000FF">?.(</span><span style="color: #A31515">&#039;, &#039;</span><span style="color: #000000FF">)</span><span style="color: #0000FF">}</span><span style="color: #A31515">`</span><span style="color: #000000">)</span>
<span style="color: #000000">        </span><span style="color: #001080">job</span><span style="color: #000000">.</span><span style="color: #795E26">complete</span><span style="color: #000000">()</span>
<span style="color: #000000">    },</span>
<span style="color: #000000">    </span><span style="color: #001080">fetchVariable:</span><span style="color: #000000"> [</span><span style="color: #A31515">&#039;name&#039;</span><span style="color: #000000">, </span><span style="color: #A31515">&#039;albums&#039;</span><span style="color: #000000">],</span>
<span style="color: #000000">})</span>
</code></pre>
				<p><a name = "decoupled-complete"></a></p>
				<a href="#the-quotdecoupled-job-completionquot-pattern" id="the-quotdecoupled-job-completionquot-pattern" style="color: inherit; text-decoration: none;">
					<h2>The &quot;Decoupled Job Completion&quot; pattern</h2>
				</a>
				<p>The <em>Decoupled Job Completion</em> pattern uses a Zeebe Job Worker to activate jobs from the broker, and some other asynchronous (remote) system to do the work.</p>
				<p>You might activate jobs and then send them to a RabbitMQ queue, or to an AWS lambda. In this case, there may be no outcome about the job that this worker can report back to the broker about success or failure. That will be the responsibility of another part of your distributed system.</p>
				<p>The first thing you should do is ensure that you activate the job with sufficient time for the complete execution of your system. Your worker will not be completing the job, but it informs the broker how long the expected loop will take to close.</p>
				<p>Next, call <code>job.forward()</code> in your job worker handler. This has no side-effect with the broker - so nothing is communicated to Zeebe. The job is still out there with your worker as far as Zeebe is concerned. What this call does is release worker capacity to request more jobs.</p>
				<p>If you are using the Zeebe Node library in the remote system, or if the remote system eventually reports back to you (perhaps over a different RabbitMQ queue), you can use the ZBClient methods <code>completeJob()</code>, <code>failJob()</code>, and <code>throwError()</code> to report the outcome back to the broker.</p>
				<p>You need at least the <code>job.key</code>, to be able to correlate the result back to Zeebe. Presumably you also want the information from the remote system about the outcome, and any updated variables.</p>
				<p>Here is an example:</p>
				<ul>
					<li>You have a COBOL system that runs a database.</li>
					<li>Somebody wrote an adapter for this COBOL database. In executes commands over SSH.</li>
					<li>The adapter is accessible via a RabbitMQ &quot;request&quot; queue, which takes a command and a correlation id, so that its response can be correlated to this request.</li>
					<li>The adapter sends back the COBOL database system response on a RabbitMQ &quot;response&quot; queue, with the correlation id.</li>
					<li>It typically takes 15 seconds for the round-trip through RabbitMQ to the COBOL database and back.</li>
				</ul>
				<p>You want to put this system into a Zeebe-orchestrated BPMN model as a task.</p>
				<p>Rather than injecting a RabbitMQ listener into the job handler, you can &quot;<em>fire and forget</em>&quot; the request using the decoupled job completion pattern.</p>
				<p>Here is how you do it:</p>
				<ul>
					<li>Your worker gets the job from Zeebe.</li>
					<li>Your worker makes the command and sends it down the RabbitMQ &quot;request&quot; queue, with the <code>job.jobKey</code> as the correlation id.</li>
					<li>Your worker calls <code>job.forward()</code></li>
				</ul>
				<p>Here is what that looks like in code:</p>
				<pre><code class="language-TypeScript"><span style="color: #AF00DB">import</span><span style="color: #000000"> { </span><span style="color: #001080">RabbitMQSender</span><span style="color: #000000"> } </span><span style="color: #AF00DB">from</span><span style="color: #000000"> </span><span style="color: #A31515">&#039;./lib/my-awesome-rabbitmq-api&#039;</span>
<span style="color: #AF00DB">import</span><span style="color: #000000"> { </span><span style="color: #001080">ZBClient</span><span style="color: #000000">, </span><span style="color: #001080">Duration</span><span style="color: #000000"> } </span><span style="color: #AF00DB">from</span><span style="color: #000000"> </span><span style="color: #A31515">&#039;zeebe-node&#039;</span>

<span style="color: #0000FF">const</span><span style="color: #000000"> </span><span style="color: #0070C1">zbc</span><span style="color: #000000"> = </span><span style="color: #0000FF">new</span><span style="color: #000000"> </span><span style="color: #795E26">ZBClient</span><span style="color: #000000">()</span>

<span style="color: #0000FF">const</span><span style="color: #000000"> </span><span style="color: #0070C1">cobolWorker</span><span style="color: #000000"> = </span><span style="color: #001080">zbc</span><span style="color: #000000">.</span><span style="color: #795E26">createWorker</span><span style="color: #000000">({</span>
<span style="color: #000000">    </span><span style="color: #001080">taskType:</span><span style="color: #000000"> </span><span style="color: #A31515">&#039;cobol-insert&#039;</span><span style="color: #000000">,</span>
<span style="color: #000000">    </span><span style="color: #001080">timeout:</span><span style="color: #000000"> </span><span style="color: #001080">Duration</span><span style="color: #000000">.</span><span style="color: #001080">seconds</span><span style="color: #000000">.</span><span style="color: #795E26">of</span><span style="color: #000000">(</span><span style="color: #098658">20</span><span style="color: #000000">), </span><span style="color: #008000">// allow 5s over the expected 15s</span>
<span style="color: #000000">    </span><span style="color: #795E26">taskHandler</span><span style="color: #001080">:</span><span style="color: #000000"> </span><span style="color: #001080">job</span><span style="color: #000000"> </span><span style="color: #0000FF">=&gt;</span><span style="color: #000000"> {</span>
<span style="color: #000000">        </span><span style="color: #0000FF">const</span><span style="color: #000000"> { </span><span style="color: #0070C1">key</span><span style="color: #000000">, </span><span style="color: #0070C1">variables</span><span style="color: #000000"> } = </span><span style="color: #001080">job</span>
<span style="color: #000000">        </span><span style="color: #0000FF">const</span><span style="color: #000000"> </span><span style="color: #0070C1">request</span><span style="color: #000000"> = {</span>
<span style="color: #000000">            </span><span style="color: #001080">correlationId:</span><span style="color: #000000"> </span><span style="color: #001080">key</span><span style="color: #000000">,</span>
<span style="color: #000000">            </span><span style="color: #001080">command:</span><span style="color: #000000"> </span><span style="color: #A31515">`INSERT </span><span style="color: #0000FF">${</span><span style="color: #001080">variables</span><span style="color: #000000FF">.</span><span style="color: #001080">customer</span><span style="color: #0000FF">}</span><span style="color: #A31515"> INTO CUSTOMERS`</span>
<span style="color: #000000">        }</span>
<span style="color: #000000">        </span><span style="color: #001080">RabbitMQSender</span><span style="color: #000000">.</span><span style="color: #795E26">send</span><span style="color: #000000">({</span>
<span style="color: #000000">            </span><span style="color: #001080">channel:</span><span style="color: #000000"> </span><span style="color: #A31515">&#039;COBOL_REQ&#039;</span><span style="color: #000000">,</span>
<span style="color: #000000">            </span><span style="color: #001080">request</span>
<span style="color: #000000">        })</span>
<span style="color: #000000">        </span><span style="color: #008000">// Call forward() to release worker capacity</span>
<span style="color: #000000">        </span><span style="color: #AF00DB">return</span><span style="color: #000000"> </span><span style="color: #001080">job</span><span style="color: #000000">.</span><span style="color: #795E26">forward</span><span style="color: #000000">()</span>
<span style="color: #000000">    }</span>
<span style="color: #000000">)</span>
</code></pre>
				<p>Now for the response part:</p>
				<ul>
					<li>Another part of your system listens to the RabbitMQ response queue.</li>
					<li>It gets a response back from the COBOL adapter.</li>
					<li>It examines the response, then sends the appropriate outcome to Zeebe, using the jobKey that has been attached as the correlationId</li>
				</ul>
				<pre><code class="language-TypeScript"><span style="color: #AF00DB">import</span><span style="color: #000000"> { </span><span style="color: #001080">RabbitMQListener</span><span style="color: #000000"> } </span><span style="color: #AF00DB">from</span><span style="color: #000000"> </span><span style="color: #A31515">&#039;./lib/my-awesome-rabbitmq-api&#039;</span>
<span style="color: #AF00DB">import</span><span style="color: #000000"> { </span><span style="color: #001080">ZBClient</span><span style="color: #000000"> } </span><span style="color: #AF00DB">from</span><span style="color: #000000"> </span><span style="color: #A31515">&#039;zeebe-node&#039;</span>

<span style="color: #0000FF">const</span><span style="color: #000000"> </span><span style="color: #0070C1">zbc</span><span style="color: #000000"> = </span><span style="color: #0000FF">new</span><span style="color: #000000"> </span><span style="color: #795E26">ZBClient</span><span style="color: #000000">()</span>

<span style="color: #0000FF">const</span><span style="color: #000000"> </span><span style="color: #0070C1">RabbitMQListener</span><span style="color: #000000">.listen({</span>
<span style="color: #000000">    channel: </span><span style="color: #A31515">&#039;COBOL_RES&#039;</span><span style="color: #000000">,</span>
<span style="color: #000000">    handler: </span><span style="color: #001080">message</span><span style="color: #000000"> </span><span style="color: #0000FF">=&gt;</span><span style="color: #000000"> {</span>
<span style="color: #000000">        </span><span style="color: #0000FF">const</span><span style="color: #000000"> { </span><span style="color: #0070C1">outcome</span><span style="color: #000000">, </span><span style="color: #0070C1">correlationId</span><span style="color: #000000"> } = </span><span style="color: #001080">message</span>
<span style="color: #000000">        </span><span style="color: #AF00DB">if</span><span style="color: #000000"> (</span><span style="color: #001080">outcome</span><span style="color: #000000">.</span><span style="color: #0070C1">SUCCESS</span><span style="color: #000000">) {</span>
<span style="color: #000000">            </span><span style="color: #001080">zbc</span><span style="color: #000000">.</span><span style="color: #795E26">completeJob</span><span style="color: #000000">({</span>
<span style="color: #000000">                </span><span style="color: #001080">jobKey:</span><span style="color: #000000"> </span><span style="color: #001080">correlationId</span><span style="color: #000000">,</span>
<span style="color: #000000">                </span><span style="color: #001080">variables:</span><span style="color: #000000"> {}</span>
<span style="color: #000000">            })</span>
<span style="color: #000000">        }</span>
<span style="color: #000000">        </span><span style="color: #AF00DB">if</span><span style="color: #000000"> (</span><span style="color: #001080">outcome</span><span style="color: #000000">.</span><span style="color: #0070C1">ERROR</span><span style="color: #000000">) {</span>
<span style="color: #000000">            </span><span style="color: #001080">zbc</span><span style="color: #000000">.</span><span style="color: #795E26">throwError</span><span style="color: #000000">({</span>
<span style="color: #000000">                </span><span style="color: #001080">jobKey:</span><span style="color: #000000"> </span><span style="color: #001080">correlationId</span><span style="color: #000000">,</span>
<span style="color: #000000">                </span><span style="color: #001080">errorCode:</span><span style="color: #000000"> </span><span style="color: #A31515">&quot;5&quot;</span><span style="color: #000000">,</span>
<span style="color: #000000">                </span><span style="color: #001080">errorMessage:</span><span style="color: #000000"> </span><span style="color: #A31515">&quot;The COBOL Database reported an error. Boo!&quot;</span>
<span style="color: #000000">            })</span>
<span style="color: #000000">        }</span>
<span style="color: #000000">    })</span>
<span style="color: #000000">}</span>
</code></pre>
				<p>See also the section &quot;<a href="#publish-message">Publish a Message</a>&quot;, for a pattern that you can use when it is not possible to attach the job key to the round trip data response.</p>
				<p><a name = "zbbatchworker"></a></p>
				<a href="#the-zbbatchworker-job-worker" id="the-zbbatchworker-job-worker" style="color: inherit; text-decoration: none;">
					<h2>The <code>ZBBatchWorker</code> Job Worker</h2>
				</a>
				<p>The <code>ZBBatchWorker</code> Job Worker batches jobs before calling the job handler. Its fundamental differences from the ZBWorker are:</p>
				<ul>
					<li>Its job handler receives an <em>array</em> of one or more jobs.</li>
					<li>The handler is not invoked immediately, but rather when enough jobs are batched, or a job in the batch is at risk of being timed out by the Zeebe broker.</li>
				</ul>
				<p>You can use the batch worker if you have tasks that <em>benefit from processing together</em>, but are <em>not related in the BPMN model</em>.</p>
				<p>An example would be a high volume of jobs that require calls to an external system, where you have to pay per call to that system. In that case, you may want to batch up jobs, make one call to the external system, then update all the jobs and send them on their way.</p>
				<p>The batch worker works on a <em>first-of</em> batch size <em>or</em> batch timeout basis.</p>
				<p>You must configure both <code>jobBatchMinSize</code> and <code>jobBatchMaxTime</code>. Whichever condition is met first will trigger the processing of the jobs:</p>
				<ul>
					<li>Enough jobs are available to the worker to satisfy the minimum job batch size;</li>
					<li>The batch has been building for the maximum amount of time - &quot;<em>we&#39;re doing this now, before the earliest jobs in the batch time out on the broker</em>&quot;.</li>
				</ul>
				<p>You should be sure to specify a <code>timeout</code> for your worker that is <code>jobBatchMaxTime</code> <em>plus</em> the expected latency of the external call <em>plus</em> your processing time and network latency, to avoid the broker timing your batch worker&#39;s lock and making the jobs available to another worker. That would defeat the whole purpose.</p>
				<p>Here is an example of using the <code>ZBBatchWorker</code>:</p>
				<pre><code class="language-TypeScript"><span style="color: #AF00DB">import</span><span style="color: #000000"> { </span><span style="color: #001080">API</span><span style="color: #000000"> } </span><span style="color: #AF00DB">from</span><span style="color: #000000"> </span><span style="color: #A31515">&#039;./lib/my-awesome-external-api&#039;</span>
<span style="color: #AF00DB">import</span><span style="color: #000000"> { </span><span style="color: #001080">ZBClient</span><span style="color: #000000">, </span><span style="color: #001080">BatchedJob</span><span style="color: #000000">, </span><span style="color: #001080">Duration</span><span style="color: #000000"> } </span><span style="color: #AF00DB">from</span><span style="color: #000000"> </span><span style="color: #A31515">&#039;zeebe-node&#039;</span>

<span style="color: #0000FF">const</span><span style="color: #000000"> </span><span style="color: #0070C1">zbc</span><span style="color: #000000"> = </span><span style="color: #0000FF">new</span><span style="color: #000000"> </span><span style="color: #795E26">ZBClient</span><span style="color: #000000">()</span>

<span style="color: #008000">// Helper function to find a job by its key</span>
<span style="color: #0000FF">const</span><span style="color: #000000"> </span><span style="color: #795E26">findJobByKey</span><span style="color: #000000"> = </span><span style="color: #001080">jobs</span><span style="color: #000000"> </span><span style="color: #0000FF">=&gt;</span><span style="color: #000000"> </span><span style="color: #001080">key</span><span style="color: #000000"> </span><span style="color: #0000FF">=&gt;</span><span style="color: #000000"> </span><span style="color: #001080">jobs</span><span style="color: #000000">.</span><span style="color: #795E26">filter</span><span style="color: #000000">(</span><span style="color: #001080">job</span><span style="color: #000000"> </span><span style="color: #0000FF">=&gt;</span><span style="color: #000000"> </span><span style="color: #001080">job</span><span style="color: #000000">.</span><span style="color: #001080">jobKey</span><span style="color: #000000"> === </span><span style="color: #001080">id</span><span style="color: #000000">)?.[</span><span style="color: #098658">0</span><span style="color: #000000">] ?? []</span>

<span style="color: #0000FF">const</span><span style="color: #000000"> </span><span style="color: #795E26">handler</span><span style="color: #000000"> = </span><span style="color: #0000FF">async</span><span style="color: #000000"> (</span><span style="color: #001080">jobs</span><span style="color: #000000">: </span><span style="color: #267F99">BatchedJob</span><span style="color: #000000">[]) </span><span style="color: #0000FF">=&gt;</span><span style="color: #000000"> {</span>
<span style="color: #000000">    </span><span style="color: #001080">console</span><span style="color: #000000">.</span><span style="color: #795E26">log</span><span style="color: #000000">(</span><span style="color: #A31515">&quot;Let&#039;s do this!&quot;</span><span style="color: #000000">)</span>
<span style="color: #000000">    </span><span style="color: #0000FF">const</span><span style="color: #000000"> {</span><span style="color: #0070C1">jobKey</span><span style="color: #000000">, </span><span style="color: #0070C1">variables</span><span style="color: #000000">} = </span><span style="color: #001080">job</span>
<span style="color: #000000">    </span><span style="color: #008000">// Construct some hypothetical payload with correlation ids and requests</span>
<span style="color: #000000">    </span><span style="color: #0000FF">const</span><span style="color: #000000"> </span><span style="color: #0070C1">req</span><span style="color: #000000"> = </span><span style="color: #001080">jobs</span><span style="color: #000000">.</span><span style="color: #795E26">map</span><span style="color: #000000">(</span><span style="color: #001080">job</span><span style="color: #000000"> </span><span style="color: #0000FF">=&gt;</span><span style="color: #000000"> ({</span><span style="color: #001080">id:</span><span style="color: #000000"> </span><span style="color: #001080">jobKey</span><span style="color: #000000">, </span><span style="color: #001080">data:</span><span style="color: #000000"> </span><span style="color: #001080">variables</span><span style="color: #000000">.</span><span style="color: #001080">request</span><span style="color: #000000">}))</span>
<span style="color: #000000">    </span><span style="color: #008000">// An uncaught exception will not be managed by the library</span>
<span style="color: #000000">    </span><span style="color: #AF00DB">try</span><span style="color: #000000"> {</span>
<span style="color: #000000">        </span><span style="color: #008000">// Our API wrapper turns that into a request, and returns</span>
<span style="color: #000000">        </span><span style="color: #008000">// an array of results with ids</span>
<span style="color: #000000">        </span><span style="color: #0000FF">const</span><span style="color: #000000"> </span><span style="color: #0070C1">outcomes</span><span style="color: #000000"> = </span><span style="color: #AF00DB">await</span><span style="color: #000000"> </span><span style="color: #0070C1">API</span><span style="color: #000000">.</span><span style="color: #795E26">post</span><span style="color: #000000">(</span><span style="color: #001080">req</span><span style="color: #000000">)</span>
<span style="color: #000000">        </span><span style="color: #008000">// Construct a find function for these jobs</span>
<span style="color: #000000">        </span><span style="color: #0000FF">const</span><span style="color: #000000"> </span><span style="color: #0070C1">getJob</span><span style="color: #000000"> = </span><span style="color: #795E26">findJobByKey</span><span style="color: #000000">(</span><span style="color: #001080">jobs</span><span style="color: #000000">)</span>
<span style="color: #000000">        </span><span style="color: #008000">// Iterate over the results and call the succeed method on the corresponding job,</span>
<span style="color: #000000">        </span><span style="color: #008000">// passing in the correlated outcome of the API call</span>
<span style="color: #000000">        </span><span style="color: #001080">outcomes</span><span style="color: #000000">.</span><span style="color: #795E26">forEach</span><span style="color: #000000">(</span><span style="color: #001080">res</span><span style="color: #000000"> </span><span style="color: #0000FF">=&gt;</span><span style="color: #000000"> </span><span style="color: #795E26">getJob</span><span style="color: #000000">(</span><span style="color: #001080">res</span><span style="color: #000000">.</span><span style="color: #001080">id</span><span style="color: #000000">)?.</span><span style="color: #795E26">complete</span><span style="color: #000000">(</span><span style="color: #001080">res</span><span style="color: #000000">.</span><span style="color: #001080">data</span><span style="color: #000000">))</span>
<span style="color: #000000">    } </span><span style="color: #AF00DB">catch</span><span style="color: #000000"> (</span><span style="color: #001080">e</span><span style="color: #000000">) {</span>
<span style="color: #000000">        </span><span style="color: #001080">jobs</span><span style="color: #000000">.</span><span style="color: #795E26">forEach</span><span style="color: #000000">(</span><span style="color: #001080">job</span><span style="color: #000000"> </span><span style="color: #0000FF">=&gt;</span><span style="color: #000000"> </span><span style="color: #001080">job</span><span style="color: #000000">.</span><span style="color: #795E26">fail</span><span style="color: #000000">(</span><span style="color: #001080">e</span><span style="color: #000000">.</span><span style="color: #001080">message</span><span style="color: #000000">))</span>
<span style="color: #000000">    }</span>
<span style="color: #000000">}</span>

<span style="color: #0000FF">const</span><span style="color: #000000"> </span><span style="color: #0070C1">batchWorker</span><span style="color: #000000"> = </span><span style="color: #001080">zbc</span><span style="color: #000000">.</span><span style="color: #795E26">createBatchWorker</span><span style="color: #000000">({</span>
<span style="color: #000000">    </span><span style="color: #001080">taskType:</span><span style="color: #000000"> </span><span style="color: #A31515">&#039;get-data-from-external-api&#039;</span><span style="color: #000000">,</span>
<span style="color: #000000">    </span><span style="color: #001080">taskHandler:</span><span style="color: #000000"> </span><span style="color: #001080">handler</span><span style="color: #000000">,</span>
<span style="color: #000000">    </span><span style="color: #001080">jobBatchMinSize:</span><span style="color: #000000"> </span><span style="color: #098658">10</span><span style="color: #000000">, </span><span style="color: #008000">// at least 10 at a time</span>
<span style="color: #000000">    </span><span style="color: #001080">jobBatchMaxTime:</span><span style="color: #000000"> </span><span style="color: #098658">60</span><span style="color: #000000">, </span><span style="color: #008000">// or every 60 seconds, whichever comes first</span>
<span style="color: #000000">    </span><span style="color: #001080">timeout:</span><span style="color: #000000"> </span><span style="color: #001080">Duration</span><span style="color: #000000">.</span><span style="color: #001080">seconds</span><span style="color: #000000">.</span><span style="color: #795E26">of</span><span style="color: #000000">(</span><span style="color: #098658">80</span><span style="color: #000000">) </span><span style="color: #008000">// 80 second timeout means we have 20 seconds to process at least</span>
<span style="color: #000000">})</span>
</code></pre>
				<p>See <a href="http://joshwulf.com/blog/2020/03/zb-batch-worker/">this blog post</a> for some more details on the implementation.</p>
				<p><a name = "long-polling"></a></p>
				<a href="#long-polling" id="long-polling" style="color: inherit; text-decoration: none;">
					<h3>Long polling</h3>
				</a>
				<p>With Zeebe 0.21 onward, long polling is supported for clients, and is used by default. Rather than polling continuously for work and getting nothing back, a client can poll once and leave the request open until work appears. This reduces network traffic and CPU utilization in the server. Every JobActivation Request is appended to the event log, so continuous polling can significantly impact broker performance, especially when an exporter is loaded (see <a href="https://github.com/zeebe-io/zeebe-client-node-js/issues/64#issuecomment-520233275">here</a>).</p>
				<p>Long polling sends the <code>ActivateJobs</code> command to the broker, and waits for up to the long poll interval for jobs to be available, rather than returning immediately with an empty response if no jobs are available at that moment.</p>
				<p>The default long poll duration is 30s.</p>
				<p>To use a different long polling duration, pass in a long poll timeout in milliseconds to the client. All workers created with that client will use it. Alternatively, set a period per-worker.</p>
				<p>Long polling for workers is configured in the ZBClient like this:</p>
				<pre><code class="language-typescript"><span style="color: #0000FF">const</span><span style="color: #000000"> { </span><span style="color: #0070C1">ZBClient</span><span style="color: #000000">, </span><span style="color: #0070C1">Duration</span><span style="color: #000000"> } = </span><span style="color: #795E26">require</span><span style="color: #000000">(</span><span style="color: #A31515">&#039;zeebe-node&#039;</span><span style="color: #000000">)</span>

<span style="color: #0000FF">const</span><span style="color: #000000"> </span><span style="color: #0070C1">zbc</span><span style="color: #000000"> = </span><span style="color: #0000FF">new</span><span style="color: #000000"> </span><span style="color: #795E26">ZBClient</span><span style="color: #000000">(</span><span style="color: #A31515">&#039;serverAddress&#039;</span><span style="color: #000000">, {</span>
<span style="color: #000000">    </span><span style="color: #001080">longPoll:</span><span style="color: #000000"> </span><span style="color: #001080">Duration</span><span style="color: #000000">.</span><span style="color: #001080">minutes</span><span style="color: #000000">.</span><span style="color: #795E26">of</span><span style="color: #000000">(</span><span style="color: #098658">10</span><span style="color: #000000">), </span><span style="color: #008000">// Ten minutes - inherited by workers</span>
<span style="color: #000000">})</span>

<span style="color: #0000FF">const</span><span style="color: #000000"> </span><span style="color: #0070C1">longPollingWorker</span><span style="color: #000000"> = </span><span style="color: #001080">zbc</span><span style="color: #000000">.</span><span style="color: #795E26">createWorker</span><span style="color: #000000">({</span>
<span style="color: #000000">    </span><span style="color: #001080">taskType:</span><span style="color: #000000"> </span><span style="color: #A31515">&#039;task-type&#039;</span><span style="color: #000000">,</span>
<span style="color: #000000">    </span><span style="color: #001080">taskHandler:</span><span style="color: #000000"> </span><span style="color: #001080">handler</span><span style="color: #000000">,</span>
<span style="color: #000000">    </span><span style="color: #001080">longPoll:</span><span style="color: #000000"> </span><span style="color: #001080">Duration</span><span style="color: #000000">.</span><span style="color: #001080">minutes</span><span style="color: #000000">.</span><span style="color: #795E26">of</span><span style="color: #000000">(</span><span style="color: #098658">2</span><span style="color: #000000">), </span><span style="color: #008000">// override client, poll 2m</span>
<span style="color: #000000">})</span>
</code></pre>
				<a name = "poll-interval">
					<a href="#poll-interval" id="poll-interval" style="color: inherit; text-decoration: none;">
						<h3>Poll Interval</h3>
					</a>
					<p>The poll interval is a timer that fires on the configured interval and sends an <code>ActivateJobs</code> command if no pending command is currently active. By default, this is set to 300ms. This guarantees that there will be a minimum of 300ms between <code>ActivateJobs</code> commands, which prevents flooding the broker.</p>
					<p>Too many <code>ActivateJobs</code> requests per period of time can cause broker backpressure to kick in, and the gateway to return a GRPC 8 error code.</p>
					<p>You can configure this with the <code>pollInterval</code> option in the client constructor, in which case all workers inherit it as their default. You can also override this by specifying a value in the <code>createWorker</code> call:</p>
					<pre><code class="language-typescript"><span style="color: #0000FF">const</span><span style="color: #000000"> </span><span style="color: #0070C1">zbc</span><span style="color: #000000"> = </span><span style="color: #0000FF">new</span><span style="color: #000000"> </span><span style="color: #795E26">ZBClient</span><span style="color: #000000">({</span>
<span style="color: #000000">    </span><span style="color: #001080">pollInterval:</span><span style="color: #000000"> </span><span style="color: #001080">Duration</span><span style="color: #000000">.</span><span style="color: #001080">milliseconds</span><span style="color: #000000">.</span><span style="color: #795E26">of</span><span style="color: #000000">(</span><span style="color: #098658">500</span><span style="color: #000000">),</span>
<span style="color: #000000">})</span>

<span style="color: #0000FF">const</span><span style="color: #000000"> </span><span style="color: #0070C1">worker</span><span style="color: #000000"> = </span><span style="color: #001080">zbc</span><span style="color: #000000">.</span><span style="color: #795E26">createWorker</span><span style="color: #000000">({</span>
<span style="color: #000000">    </span><span style="color: #001080">taskType:</span><span style="color: #000000"> </span><span style="color: #A31515">&#039;send-email&#039;</span><span style="color: #000000">,</span>
<span style="color: #000000">    </span><span style="color: #001080">taskHandler:</span><span style="color: #000000"> </span><span style="color: #001080">sendEmailWorkerHandler</span><span style="color: #000000">,</span>
<span style="color: #000000">    </span><span style="color: #001080">pollInterval:</span><span style="color: #000000"> </span><span style="color: #001080">Duration</span><span style="color: #000000">.</span><span style="color: #001080">milliseconds</span><span style="color: #000000">.</span><span style="color: #795E26">of</span><span style="color: #000000">(</span><span style="color: #098658">750</span><span style="color: #000000">),</span>
<span style="color: #000000">})</span>
</code></pre>
					<a href="#client-commands" id="client-commands" style="color: inherit; text-decoration: none;">
						<h2>Client Commands</h2>
					</a>
					<p><a name = "deploy-resource"></a></p>
					<a href="#deploy-process-models-and-decision-tables" id="deploy-process-models-and-decision-tables" style="color: inherit; text-decoration: none;">
						<h3>Deploy Process Models and Decision Tables</h3>
					</a>
					<p>From version 8 of Zeebe, <code>deployProcess</code> in deprecated in favor of <code>deployResource</code> which allows you to deploy both process models and DMN tables.</p>
					<p>You can deploy a resource as a buffer, or by passing a filename - in which case the client library will load the file into a buffer for you.</p>
					<a href="#deploy-process-model" id="deploy-process-model" style="color: inherit; text-decoration: none;">
						<h3>Deploy Process Model</h3>
					</a>
					<p>By passing a filename, and allowing the client library to load the file into a buffer:</p>
					<pre><code class="language-typescript"><span style="color: #0000FF">async</span><span style="color: #000000"> </span><span style="color: #0000FF">function</span><span style="color: #000000"> </span><span style="color: #795E26">deploy</span><span style="color: #000000">() {</span>
<span style="color: #000000">    </span><span style="color: #0000FF">const</span><span style="color: #000000"> </span><span style="color: #0070C1">zbc</span><span style="color: #000000"> = </span><span style="color: #0000FF">new</span><span style="color: #000000"> </span><span style="color: #795E26">ZBClient</span><span style="color: #000000">()</span>
<span style="color: #000000">    </span><span style="color: #0000FF">const</span><span style="color: #000000"> </span><span style="color: #0070C1">result</span><span style="color: #000000"> = </span><span style="color: #AF00DB">await</span><span style="color: #000000"> </span><span style="color: #001080">zbc</span><span style="color: #000000">.</span><span style="color: #795E26">deployResource</span><span style="color: #000000">({</span>
<span style="color: #000000">        </span><span style="color: #001080">processFilename:</span><span style="color: #000000"> </span><span style="color: #A31515">`./src/__tests__/testdata/Client-DeployWorkflow.bpmn`</span><span style="color: #000000">,</span>
<span style="color: #000000">    })</span>
<span style="color: #000000">}</span>
</code></pre>
					<p>By passing a buffer, and a name:</p>
					<pre><code class="language-typescript"><span style="color: #0000FF">async</span><span style="color: #000000"> </span><span style="color: #0000FF">function</span><span style="color: #000000"> </span><span style="color: #795E26">deploy</span><span style="color: #000000">() {</span>
<span style="color: #000000">    </span><span style="color: #0000FF">const</span><span style="color: #000000"> </span><span style="color: #0070C1">zbc</span><span style="color: #000000"> = </span><span style="color: #0000FF">new</span><span style="color: #000000"> </span><span style="color: #795E26">ZBClient</span><span style="color: #000000">()</span>
<span style="color: #000000">    </span><span style="color: #0000FF">const</span><span style="color: #000000"> </span><span style="color: #0070C1">process</span><span style="color: #000000"> = </span><span style="color: #001080">fs</span><span style="color: #000000">.</span><span style="color: #795E26">readFileSync</span><span style="color: #000000">(</span>
<span style="color: #000000">        </span><span style="color: #A31515">`./src/__tests__/testdata/Client-DeployWorkflow.bpmn`</span>
<span style="color: #000000">    )</span>
<span style="color: #000000">    </span><span style="color: #0000FF">const</span><span style="color: #000000"> </span><span style="color: #0070C1">result</span><span style="color: #000000"> = </span><span style="color: #AF00DB">await</span><span style="color: #000000"> </span><span style="color: #001080">zbc</span><span style="color: #000000">.</span><span style="color: #795E26">deployResource</span><span style="color: #000000">({</span>
<span style="color: #000000">        </span><span style="color: #001080">process</span><span style="color: #000000">,</span>
<span style="color: #000000">        </span><span style="color: #001080">name:</span><span style="color: #000000"> </span><span style="color: #A31515">`Client-DeployWorkflow.bpmn`</span><span style="color: #000000">,</span>
<span style="color: #000000">    })</span>
<span style="color: #000000">}</span>
</code></pre>
					<a href="#deploy-dmn-table" id="deploy-dmn-table" style="color: inherit; text-decoration: none;">
						<h3>Deploy DMN Table</h3>
					</a>
					<p>By passing a filename, and allowing the client library to load the file into a buffer:</p>
					<pre><code class="language-typescript"><span style="color: #0000FF">async</span><span style="color: #000000"> </span><span style="color: #0000FF">function</span><span style="color: #000000"> </span><span style="color: #795E26">deploy</span><span style="color: #000000">() {</span>
<span style="color: #000000">    </span><span style="color: #0000FF">const</span><span style="color: #000000"> </span><span style="color: #0070C1">zbc</span><span style="color: #000000"> = </span><span style="color: #0000FF">new</span><span style="color: #000000"> </span><span style="color: #795E26">ZBClient</span><span style="color: #000000">()</span>
<span style="color: #000000">    </span><span style="color: #0000FF">const</span><span style="color: #000000"> </span><span style="color: #0070C1">result</span><span style="color: #000000"> = </span><span style="color: #AF00DB">await</span><span style="color: #000000"> </span><span style="color: #001080">zbc</span><span style="color: #000000">.</span><span style="color: #795E26">deployResource</span><span style="color: #000000">({</span>
<span style="color: #000000">        </span><span style="color: #001080">decisionFilename:</span><span style="color: #000000"> </span><span style="color: #A31515">`./src/__tests__/testdata/quarantine-duration.dmn`</span><span style="color: #000000">,</span>
<span style="color: #000000">    })</span>
<span style="color: #000000">}</span>
</code></pre>
					<p>By passing a buffer, and a name:</p>
					<pre><code class="language-typescript"><span style="color: #0000FF">async</span><span style="color: #000000"> </span><span style="color: #0000FF">function</span><span style="color: #000000"> </span><span style="color: #795E26">deploy</span><span style="color: #000000">() {</span>
<span style="color: #000000">    </span><span style="color: #0000FF">const</span><span style="color: #000000"> </span><span style="color: #0070C1">zbc</span><span style="color: #000000"> = </span><span style="color: #0000FF">new</span><span style="color: #000000"> </span><span style="color: #795E26">ZBClient</span><span style="color: #000000">()</span>
<span style="color: #000000">    </span><span style="color: #0000FF">const</span><span style="color: #000000"> </span><span style="color: #0070C1">decision</span><span style="color: #000000"> = </span><span style="color: #001080">fs</span><span style="color: #000000">.</span><span style="color: #795E26">readFileSync</span><span style="color: #000000">(</span>
<span style="color: #000000">        </span><span style="color: #A31515">`./src/__tests__/testdata/quarantine-duration.dmn`</span>
<span style="color: #000000">    )</span>
<span style="color: #000000">    </span><span style="color: #0000FF">const</span><span style="color: #000000"> </span><span style="color: #0070C1">result</span><span style="color: #000000"> = </span><span style="color: #AF00DB">await</span><span style="color: #000000"> </span><span style="color: #001080">zbc</span><span style="color: #000000">.</span><span style="color: #795E26">deployResource</span><span style="color: #000000">({</span>
<span style="color: #000000">        </span><span style="color: #001080">decision</span><span style="color: #000000">,</span>
<span style="color: #000000">        </span><span style="color: #001080">name:</span><span style="color: #000000"> </span><span style="color: #A31515">`quarantine-duration.dmn`</span><span style="color: #000000">,</span>
<span style="color: #000000">    })</span>
<span style="color: #000000">}</span>
</code></pre>
					<a href="#deploy-form" id="deploy-form" style="color: inherit; text-decoration: none;">
						<h3>Deploy Form</h3>
					</a>
					<p>From 8.3.1, you can deploy a form to the Zeebe broker:</p>
					<pre><code class="language-javascript"><span style="color: #0000FF">async</span><span style="color: #000000"> </span><span style="color: #0000FF">function</span><span style="color: #000000"> </span><span style="color: #795E26">deploy</span><span style="color: #000000">() {</span>
<span style="color: #000000">    </span><span style="color: #0000FF">const</span><span style="color: #000000"> </span><span style="color: #0070C1">zbc</span><span style="color: #000000"> = </span><span style="color: #0000FF">new</span><span style="color: #000000"> </span><span style="color: #795E26">ZBClient</span><span style="color: #000000">()</span>
<span style="color: #000000">    </span><span style="color: #0000FF">const</span><span style="color: #000000"> </span><span style="color: #0070C1">form</span><span style="color: #000000"> = </span><span style="color: #001080">fs</span><span style="color: #000000">.</span><span style="color: #795E26">readFileSync</span><span style="color: #000000">(</span>
<span style="color: #000000">        </span><span style="color: #A31515">&#039;./src/__tests__/testdata/form_1.form&#039;</span>
<span style="color: #000000">    )</span>
<span style="color: #000000">    </span><span style="color: #0000FF">const</span><span style="color: #000000"> </span><span style="color: #0070C1">result</span><span style="color: #000000"> = </span><span style="color: #AF00DB">await</span><span style="color: #000000"> </span><span style="color: #001080">zbc</span><span style="color: #000000">.</span><span style="color: #795E26">deployResource</span><span style="color: #000000">({</span>
<span style="color: #000000">        </span><span style="color: #001080">form</span><span style="color: #000000">,</span>
<span style="color: #000000">        </span><span style="color: #001080">name:</span><span style="color: #000000"> </span><span style="color: #A31515">&#039;form_1.form&#039;</span><span style="color: #000000">,</span>
<span style="color: #000000">    })</span>
<span style="color: #000000">}</span>
</code></pre>
					<p><a name = "start-process"></a></p>
					<a href="#start-a-process-instance" id="start-a-process-instance" style="color: inherit; text-decoration: none;">
						<h3>Start a Process Instance</h3>
					</a>
					<pre><code class="language-javascript"><span style="color: #0000FF">const</span><span style="color: #000000"> </span><span style="color: #0070C1">ZB</span><span style="color: #000000"> = </span><span style="color: #795E26">require</span><span style="color: #000000">(</span><span style="color: #A31515">&#039;zeebe-node&#039;</span><span style="color: #000000">)</span>

<span style="color: #000000">;(</span><span style="color: #0000FF">async</span><span style="color: #000000"> () </span><span style="color: #0000FF">=&gt;</span><span style="color: #000000"> {</span>
<span style="color: #000000">    </span><span style="color: #0000FF">const</span><span style="color: #000000"> </span><span style="color: #0070C1">zbc</span><span style="color: #000000"> = </span><span style="color: #0000FF">new</span><span style="color: #000000"> </span><span style="color: #0070C1">ZB</span><span style="color: #000000">.</span><span style="color: #795E26">ZBClient</span><span style="color: #000000">(</span><span style="color: #A31515">&#039;localhost:26500&#039;</span><span style="color: #000000">)</span>
<span style="color: #000000">    </span><span style="color: #0000FF">const</span><span style="color: #000000"> </span><span style="color: #0070C1">result</span><span style="color: #000000"> = </span><span style="color: #AF00DB">await</span><span style="color: #000000"> </span><span style="color: #001080">zbc</span><span style="color: #000000">.</span><span style="color: #795E26">createProcessInstance</span><span style="color: #000000">({</span>
<span style="color: #000000">        </span><span style="color: #001080">bpmnProcessId:</span><span style="color: #000000"> </span><span style="color: #A31515">&#039;test-process&#039;</span><span style="color: #000000">,</span>
<span style="color: #000000">        </span><span style="color: #001080">variables:</span><span style="color: #000000"> {</span>
<span style="color: #000000">            </span><span style="color: #001080">testData:</span><span style="color: #000000"> </span><span style="color: #A31515">&#039;something&#039;</span>
<span style="color: #000000">        }</span>
<span style="color: #000000">    })</span>
<span style="color: #000000">    </span><span style="color: #001080">console</span><span style="color: #000000">.</span><span style="color: #795E26">log</span><span style="color: #000000">(</span><span style="color: #001080">result</span><span style="color: #000000">)</span>
<span style="color: #000000">})()</span>
</code></pre>
					<p>Example output:</p>
					<pre><code class="language-javascript">
<span style="color: #000000">{ processKey: </span><span style="color: #A31515">&#039;3&#039;</span><span style="color: #000000">,</span>
<span style="color: #000000">  bpmnProcessId: </span><span style="color: #A31515">&#039;test-process&#039;</span><span style="color: #000000">,</span>
<span style="color: #000000">  version: </span><span style="color: #098658">1</span><span style="color: #000000">,</span>
<span style="color: #000000">  processInstanceKey: </span><span style="color: #A31515">&#039;569&#039;</span><span style="color: #000000"> }</span>

</code></pre>
					<p><a name = "start-specific-version"></a></p>
					<a href="#start-a-process-instance-of-a-specific-version-of-a-process-definition" id="start-a-process-instance-of-a-specific-version-of-a-process-definition" style="color: inherit; text-decoration: none;">
						<h3>Start a Process Instance of a specific version of a Process definition</h3>
					</a>
					<p>From version 0.22 of the client onward:</p>
					<pre><code class="language-javascript"><span style="color: #0000FF">const</span><span style="color: #000000"> </span><span style="color: #0070C1">ZB</span><span style="color: #000000"> = </span><span style="color: #795E26">require</span><span style="color: #000000">(</span><span style="color: #A31515">&#039;zeebe-node&#039;</span><span style="color: #000000">)</span>

<span style="color: #000000">;(</span><span style="color: #0000FF">async</span><span style="color: #000000"> () </span><span style="color: #0000FF">=&gt;</span><span style="color: #000000"> {</span>
<span style="color: #000000">    </span><span style="color: #0000FF">const</span><span style="color: #000000"> </span><span style="color: #0070C1">zbc</span><span style="color: #000000"> = </span><span style="color: #0000FF">new</span><span style="color: #000000"> </span><span style="color: #0070C1">ZB</span><span style="color: #000000">.</span><span style="color: #795E26">ZBClient</span><span style="color: #000000">(</span><span style="color: #A31515">&#039;localhost:26500&#039;</span><span style="color: #000000">)</span>
<span style="color: #000000">    </span><span style="color: #0000FF">const</span><span style="color: #000000"> </span><span style="color: #0070C1">result</span><span style="color: #000000"> = </span><span style="color: #AF00DB">await</span><span style="color: #000000"> </span><span style="color: #001080">zbc</span><span style="color: #000000">.</span><span style="color: #795E26">createProcessInstance</span><span style="color: #000000">({</span>
<span style="color: #000000">        </span><span style="color: #001080">bpmnProcessId:</span><span style="color: #000000"> </span><span style="color: #A31515">&#039;test-process&#039;</span><span style="color: #000000">,</span>
<span style="color: #000000">        </span><span style="color: #001080">variables:</span><span style="color: #000000"> {</span>
<span style="color: #000000">            </span><span style="color: #001080">testData:</span><span style="color: #000000"> </span><span style="color: #A31515">&#039;something&#039;</span><span style="color: #000000">,</span>
<span style="color: #000000">        },</span>
<span style="color: #000000">        </span><span style="color: #001080">version:</span><span style="color: #000000"> </span><span style="color: #098658">5</span><span style="color: #000000">,</span>
<span style="color: #000000">    })</span>
<span style="color: #000000">    </span><span style="color: #001080">console</span><span style="color: #000000">.</span><span style="color: #795E26">log</span><span style="color: #000000">(</span><span style="color: #001080">result</span><span style="color: #000000">)</span>
<span style="color: #000000">})()</span>
</code></pre>
					<p><a name = "start-await"></a></p>
					<a href="#start-a-process-instance-and-await-the-process-outcome" id="start-a-process-instance-and-await-the-process-outcome" style="color: inherit; text-decoration: none;">
						<h3>Start a Process Instance and await the Process Outcome</h3>
					</a>
					<p>From version 0.22 of the broker and client, you can await the outcome of a process end-to-end execution:</p>
					<pre><code class="language-typescript"><span style="color: #0000FF">async</span><span style="color: #000000"> </span><span style="color: #0000FF">function</span><span style="color: #000000"> </span><span style="color: #795E26">getOutcome</span><span style="color: #000000">() {</span>
<span style="color: #000000">    </span><span style="color: #0000FF">const</span><span style="color: #000000"> </span><span style="color: #0070C1">result</span><span style="color: #000000"> = </span><span style="color: #AF00DB">await</span><span style="color: #000000"> </span><span style="color: #001080">zbc</span><span style="color: #000000">.</span><span style="color: #795E26">createProcessInstanceWithResult</span><span style="color: #000000">({</span>
<span style="color: #000000">        </span><span style="color: #001080">bpmnProcessId:</span><span style="color: #000000"> </span><span style="color: #001080">processId</span><span style="color: #000000">,</span>
<span style="color: #000000">        </span><span style="color: #001080">variables:</span><span style="color: #000000"> {</span>
<span style="color: #000000">            </span><span style="color: #001080">sourceValue:</span><span style="color: #000000"> </span><span style="color: #098658">5</span>
<span style="color: #000000">        }</span>
<span style="color: #000000">    })</span>
<span style="color: #000000">    </span><span style="color: #AF00DB">return</span><span style="color: #000000"> </span><span style="color: #001080">result</span>
<span style="color: #000000">}</span>
</code></pre>
					<p>Be aware that by default, <strong>this will throw an exception if the process takes longer than 15 seconds to complete</strong>.</p>
					<p>To override the gateway&#39;s default timeout for a process that needs more time to complete:</p>
					<pre><code class="language-typescript"><span style="color: #0000FF">const</span><span style="color: #000000"> { </span><span style="color: #0070C1">ZBClient</span><span style="color: #000000">, </span><span style="color: #0070C1">Duration</span><span style="color: #000000"> } = </span><span style="color: #795E26">require</span><span style="color: #000000">(</span><span style="color: #A31515">&#039;zeebe-node&#039;</span><span style="color: #000000">)</span>

<span style="color: #0000FF">const</span><span style="color: #000000"> </span><span style="color: #0070C1">zbc</span><span style="color: #000000"> = </span><span style="color: #0000FF">new</span><span style="color: #000000"> </span><span style="color: #795E26">ZBClient</span><span style="color: #000000">()</span>

<span style="color: #0000FF">const</span><span style="color: #000000"> </span><span style="color: #0070C1">result</span><span style="color: #000000"> = </span><span style="color: #AF00DB">await</span><span style="color: #000000"> </span><span style="color: #001080">zbc</span><span style="color: #000000">.</span><span style="color: #795E26">createProcessInstanceWithResult</span><span style="color: #000000">({</span>
<span style="color: #000000">    </span><span style="color: #001080">bpmnProcessId:</span><span style="color: #000000"> </span><span style="color: #001080">processId</span><span style="color: #000000">,</span>
<span style="color: #000000">    </span><span style="color: #001080">variables:</span><span style="color: #000000"> {</span>
<span style="color: #000000">        </span><span style="color: #001080">sourceValue:</span><span style="color: #000000"> </span><span style="color: #098658">5</span><span style="color: #000000">,</span>
<span style="color: #000000">        </span><span style="color: #001080">otherValue:</span><span style="color: #000000"> </span><span style="color: #A31515">&#039;rome&#039;</span><span style="color: #000000">,</span>
<span style="color: #000000">    },</span>
<span style="color: #000000">    </span><span style="color: #001080">requestTimeout:</span><span style="color: #000000"> </span><span style="color: #001080">Duration</span><span style="color: #000000">.</span><span style="color: #001080">seconds</span><span style="color: #000000">.</span><span style="color: #795E26">of</span><span style="color: #000000">(</span><span style="color: #098658">25</span><span style="color: #000000">),</span>
<span style="color: #000000">    </span><span style="color: #008000">// also works supplying a number of milliseconds</span>
<span style="color: #000000">    </span><span style="color: #008000">// requestTimeout: 25000</span>
<span style="color: #000000">})</span>
</code></pre>
					<p><a name = "publish-message"></a></p>
					<a href="#publish-a-message" id="publish-a-message" style="color: inherit; text-decoration: none;">
						<h3>Publish a Message</h3>
					</a>
					<p>You can publish a message to the Zeebe broker that will be correlated with a running process instance:</p>
					<pre><code class="language-javascript"><span style="color: #0000FF">const</span><span style="color: #000000"> { </span><span style="color: #0070C1">ZBClient</span><span style="color: #000000">, </span><span style="color: #0070C1">Duration</span><span style="color: #000000"> } = </span><span style="color: #795E26">require</span><span style="color: #000000">(</span><span style="color: #A31515">&#039;zeebe-node&#039;</span><span style="color: #000000">)</span>

<span style="color: #0000FF">const</span><span style="color: #000000"> </span><span style="color: #0070C1">zbc</span><span style="color: #000000"> = </span><span style="color: #0000FF">new</span><span style="color: #000000"> </span><span style="color: #795E26">ZBClient</span><span style="color: #000000">()</span>

<span style="color: #001080">zbc</span><span style="color: #000000">.</span><span style="color: #795E26">publishMessage</span><span style="color: #000000">({</span>
<span style="color: #000000">    </span><span style="color: #001080">correlationKey:</span><span style="color: #000000"> </span><span style="color: #A31515">&#039;value-to-correlate-with-process-variable&#039;</span><span style="color: #000000">,</span>
<span style="color: #000000">    </span><span style="color: #001080">messageId:</span><span style="color: #000000"> </span><span style="color: #001080">uuid</span><span style="color: #000000">.</span><span style="color: #795E26">v4</span><span style="color: #000000">(),</span>
<span style="color: #000000">    </span><span style="color: #001080">name:</span><span style="color: #000000"> </span><span style="color: #A31515">&#039;message-name&#039;</span><span style="color: #000000">,</span>
<span style="color: #000000">    </span><span style="color: #001080">variables:</span><span style="color: #000000"> { </span><span style="color: #001080">valueToAddToProcessVariables:</span><span style="color: #000000"> </span><span style="color: #A31515">&#039;here&#039;</span><span style="color: #000000">, </span><span style="color: #001080">status:</span><span style="color: #000000"> </span><span style="color: #A31515">&#039;PROCESSED&#039;</span><span style="color: #000000"> },</span>
<span style="color: #000000">    </span><span style="color: #001080">timeToLive:</span><span style="color: #000000"> </span><span style="color: #001080">Duration</span><span style="color: #000000">.</span><span style="color: #001080">seconds</span><span style="color: #000000">.</span><span style="color: #795E26">of</span><span style="color: #000000">(</span><span style="color: #098658">10</span><span style="color: #000000">), </span><span style="color: #008000">// seconds</span>
<span style="color: #000000">})</span>
</code></pre>
					<p>When would you do this? Well, the sky is not even the limit when it comes to thinking creatively about building a system with Zeebe - <em>and</em> here&#39;s one concrete example to get you thinking:</p>
					<p>Recall the example of the <em>remote COBOL database</em> in the section &quot;<a href="#decoupled-complete">The &quot;Decoupled Job Completion&quot; pattern</a>&quot;. We&#39;re writing code to allow that system to be participate in a BPMN-modelling process orchestrated by Zeebe.</p>
					<p>But what happens if the adapter for that system has been written in such a way that there is no opportunity to attach metadata to it? In that case we have no opportunity to attach a job key. Maybe you send the fixed data for the command, and you have to correlate the response based on those fields.</p>
					<p>Another example: think of a system that emits events, and has no knowledge of a running process. An example from one system that I orchestrate with Zeebe is Minecraft. A logged-in user in the game performs some action, and code in the game emits an event. I can catch that event in my Node-based application, but I have no knowledge of which running process to target - <em>and</em> the event was not generated from a BPMN task providing a worker with the complete context of a process.</p>
					<p>In these two cases, I can publish a message to Zeebe, and let the broker figure out which processes are:</p>
					<ul>
						<li>Sitting at an intermediate message catch event waiting for this message; or</li>
						<li>In a sub-process that has a boundary event that will be triggered by this message; or</li>
						<li>Would be started by a message start event, on receiving this message.</li>
					</ul>
					<p>The Zeebe broker correlates a message to a running process instance <em>not on the job key</em> - but on <em>the value of one of the process variables</em> (for intermediate message events) and <em>the message name</em> (for all message events, including start messages).</p>
					<p>So the response from your COBOL database system, sans job key, is sent back to Zeebe from the RabbitMQListener not via <code>completeJob()</code>, but with <code>publishMessage()</code>, and the value of the payload is used to figure out which process it is for.</p>
					<p>In the case of the Minecraft event, a message is published to Zeebe with the Minecraft username, and that is used by Zeebe to determine which processes are running for that user and are interested in that event.</p>
					<p>See the article &quot;<a href="https://zeebe.io/blog/2019/08/zeebe-message-correlation/">Zeebe Message Correlation</a>&quot; for a complete example with code.</p>
					<p><a name="publish-start-message"></a></p>
					<a href="#publish-a-start-message" id="publish-a-start-message" style="color: inherit; text-decoration: none;">
						<h3>Publish a Start Message</h3>
					</a>
					<p>You can also publish a message targeting a <a href="https://github.com/zeebe-io/zeebe/issues/1858">Message Start Event</a>.
					In this case, the correlation key is optional, and all Message Start events that match the <code>name</code> property will receive the message.</p>
					<p>You can use the <code>publishStartMessage()</code> method to publish a message with no correlation key (it will be set to a random uuid in the background):</p>
					<pre><code class="language-javascript"><span style="color: #0000FF">const</span><span style="color: #000000"> { </span><span style="color: #0070C1">ZBClient</span><span style="color: #000000">, </span><span style="color: #0070C1">Duration</span><span style="color: #000000"> } = </span><span style="color: #795E26">require</span><span style="color: #000000">(</span><span style="color: #A31515">&#039;zeebe-node&#039;</span><span style="color: #000000">)</span>

<span style="color: #0000FF">const</span><span style="color: #000000"> </span><span style="color: #0070C1">zbc</span><span style="color: #000000"> = </span><span style="color: #0000FF">new</span><span style="color: #000000"> </span><span style="color: #0070C1">ZB</span><span style="color: #000000">.</span><span style="color: #795E26">ZBClient</span><span style="color: #000000">(</span><span style="color: #A31515">&#039;localhost:26500&#039;</span><span style="color: #000000">)</span>
<span style="color: #001080">zbc</span><span style="color: #000000">.</span><span style="color: #795E26">publishStartMessage</span><span style="color: #000000">({</span>
<span style="color: #000000">    </span><span style="color: #001080">messageId:</span><span style="color: #000000"> </span><span style="color: #001080">uuid</span><span style="color: #000000">.</span><span style="color: #795E26">v4</span><span style="color: #000000">(),</span>
<span style="color: #000000">    </span><span style="color: #001080">name:</span><span style="color: #000000"> </span><span style="color: #A31515">&#039;message-name&#039;</span><span style="color: #000000">,</span>
<span style="color: #000000">    </span><span style="color: #001080">variables:</span><span style="color: #000000"> { </span><span style="color: #001080">initialProcessVariable:</span><span style="color: #000000"> </span><span style="color: #A31515">&#039;here&#039;</span><span style="color: #000000"> },</span>
<span style="color: #000000">    </span><span style="color: #001080">timeToLive:</span><span style="color: #000000"> </span><span style="color: #001080">Duration</span><span style="color: #000000">.</span><span style="color: #001080">seconds</span><span style="color: #000000">.</span><span style="color: #795E26">of</span><span style="color: #000000">(</span><span style="color: #098658">10</span><span style="color: #000000">), </span><span style="color: #008000">// seconds</span>
<span style="color: #000000">})</span>
</code></pre>
					<p>Both normal messages and start messages can be published idempotently by setting both the <code>messageId</code> and the <code>correlationKey</code>. They will only ever be correlated once. See: <a href="https://github.com/zeebe-io/zeebe/issues/1012">A message can be published idempotent</a>.</p>
					<p><a name="activate-jobs"></a></p>
					<a href="#activate-jobs" id="activate-jobs" style="color: inherit; text-decoration: none;">
						<h3>Activate Jobs</h3>
					</a>
					<p>If you have some use case that doesn&#39;t fit the existing workers, you can write your own custom workers using the <code>ZBClient.activateJobs()</code> method. It takes an <code>ActivateJobsRequest</code> object, and returns a stream for that call.</p>
					<p>Attach a listener to the stream&#39;s &#39;data&#39; event, and it will be called with an <code>ActivateJobsResponse</code> object if there are jobs to work on.</p>
					<p>To complete these jobs, use the <code>ZBClient</code> methods <code>completeJob()</code>, <code>failJob()</code>, and <code>throwError()</code>.</p>
					<p>For more details, read the source code of the library, particularly the <code>ZBWorkerBase</code> class. This is an advanced use case, and the existing code in the library is the best documentation.</p>
					<a href="#other-concerns" id="other-concerns" style="color: inherit; text-decoration: none;">
						<h2>Other Concerns</h2>
					</a>
					<p><a name = "graceful-shutdown"></a></p>
					<a href="#graceful-shutdown" id="graceful-shutdown" style="color: inherit; text-decoration: none;">
						<h3>Graceful Shutdown</h3>
					</a>
					<p>To drain workers, call the <code>close()</code> method of the ZBClient. This causes all workers using that client to stop polling for jobs, and returns a Promise that resolves when all active jobs have either finished or timed out.</p>
					<pre><code class="language-javascript"><span style="color: #001080">console</span><span style="color: #000000">.</span><span style="color: #795E26">log</span><span style="color: #000000">(</span><span style="color: #A31515">&#039;Closing client...&#039;</span><span style="color: #000000">)</span>
<span style="color: #001080">zbc</span><span style="color: #000000">.</span><span style="color: #795E26">close</span><span style="color: #000000">().</span><span style="color: #795E26">then</span><span style="color: #000000">(() </span><span style="color: #0000FF">=&gt;</span><span style="color: #000000"> </span><span style="color: #001080">console</span><span style="color: #000000">.</span><span style="color: #795E26">log</span><span style="color: #000000">(</span><span style="color: #A31515">&#039;All workers closed&#039;</span><span style="color: #000000">))</span>
</code></pre>
					<p><a name = "logging"></a></p>
					<a href="#logging" id="logging" style="color: inherit; text-decoration: none;">
						<h2>Logging</h2>
					</a>
					<p>Control the log output for the client library by setting the ZBClient log level. Valid log levels are <code>NONE</code> (supress all logging), <code>ERROR</code> (log only exceptions), <code>INFO</code> (general logging), or <code>DEBUG</code> (verbose logging). You can set this in the client constructor:</p>
					<pre><code class="language-typescript"><span style="color: #0000FF">const</span><span style="color: #000000"> </span><span style="color: #0070C1">zbc</span><span style="color: #000000"> = </span><span style="color: #0000FF">new</span><span style="color: #000000"> </span><span style="color: #795E26">ZBClient</span><span style="color: #000000">(</span><span style="color: #A31515">&#039;localhost&#039;</span><span style="color: #000000">, { </span><span style="color: #001080">loglevel:</span><span style="color: #000000"> </span><span style="color: #A31515">&#039;DEBUG&#039;</span><span style="color: #000000"> })</span>
</code></pre>
					<p>And also via the environment:</p>
					<pre><code class="language-bash"><span style="color: #000000">ZEEBE_NODE_LOG_LEVEL=</span><span style="color: #A31515">&#039;ERROR&#039;</span><span style="color: #000000"> node start.js</span>
</code></pre>
					<p>By default the library uses <code>console.info</code> and <code>console.error</code> for logging. You can also pass in a custom logger, such as <a href="https://github.com/pinojs/pino">pino</a>:</p>
					<pre><code class="language-typescript"><span style="color: #0000FF">const</span><span style="color: #000000"> </span><span style="color: #0070C1">logger</span><span style="color: #000000"> = </span><span style="color: #795E26">require</span><span style="color: #000000">(</span><span style="color: #A31515">&#039;pino&#039;</span><span style="color: #000000">)()</span>
<span style="color: #0000FF">const</span><span style="color: #000000"> </span><span style="color: #0070C1">zbc</span><span style="color: #000000"> = </span><span style="color: #0000FF">new</span><span style="color: #000000"> </span><span style="color: #795E26">ZBClient</span><span style="color: #000000">({ </span><span style="color: #001080">stdout:</span><span style="color: #000000"> </span><span style="color: #001080">logger</span><span style="color: #000000"> })</span>
</code></pre>
					<p>From version v0.23.0-alpha.1, the library logs human-readable logs by default, using the <code>ZBSimpleLogger</code>. If you want structured logs as stringified JSON, pass in <code>ZBJSONLogger</code> to the constructor <code>stdout</code> option, like this:</p>
					<pre><code class="language-typescript"><span style="color: #0000FF">const</span><span style="color: #000000"> { </span><span style="color: #0070C1">ZBJsonLogger</span><span style="color: #000000">, </span><span style="color: #0070C1">ZBClient</span><span style="color: #000000"> } = </span><span style="color: #795E26">require</span><span style="color: #000000">(</span><span style="color: #A31515">&#039;zeebe-node&#039;</span><span style="color: #000000">)</span>
<span style="color: #0000FF">const</span><span style="color: #000000"> </span><span style="color: #0070C1">zbc</span><span style="color: #000000"> = </span><span style="color: #0000FF">new</span><span style="color: #000000"> </span><span style="color: #795E26">ZBClient</span><span style="color: #000000">({ </span><span style="color: #001080">stdout:</span><span style="color: #000000"> </span><span style="color: #001080">ZBJsonLogger</span><span style="color: #000000"> })</span>
</code></pre>
					<p>You can also control this via environment variables:</p>
					<pre><code class="language-bash"><span style="color: #0000FF">export</span><span style="color: #000000"> ZEEBE_NODE_LOG_TYPE=SIMPLE  </span><span style="color: #008000"># Simple Logger (default)</span>
<span style="color: #0000FF">export</span><span style="color: #000000"> ZEEBE_NODE_LOG_TYPE=JSON  </span><span style="color: #008000"># JSON Logger</span>
</code></pre>
					<p><a name = "generate-constants"></a></p>
					<a href="#generating-typescript-constants-for-bpmn-models" id="generating-typescript-constants-for-bpmn-models" style="color: inherit; text-decoration: none;">
						<h3>Generating TypeScript constants for BPMN Models</h3>
					</a>
					<p>Message names and Task Types are untyped magic strings. You can generate type information to avoid some classes of errors.</p>
					<a href="#0220-alpha5-and-above" id="0220-alpha5-and-above" style="color: inherit; text-decoration: none;">
						<h4>0.22.0-alpha.5 and above</h4>
					</a>
					<p>Install the package globally:</p>
					<pre><code><span style="color: #001080">npm</span><span style="color: #000000"> </span><span style="color: #001080">i</span><span style="color: #000000"> -</span><span style="color: #001080">g</span><span style="color: #000000"> </span><span style="color: #001080">zeebe</span><span style="color: #000000">-</span><span style="color: #001080">node</span>
</code></pre>
					<p>Now you have the command <code>zeebe-node &lt;filename&gt;</code> that parses a BPMN file and emits type definitions.</p>
					<a href="#all-versions" id="all-versions" style="color: inherit; text-decoration: none;">
						<h4>All versions</h4>
					</a>
					<p>The <code>BpmnParser</code> class provides a static method <code>generateConstantsForBpmnFiles()</code>.
					This method takes a filepath and returns TypeScript definitions that you can use to avoid typos in your code, and to reason about the completeness of your task worker coverage.</p>
					<pre><code class="language-javascript"><span style="color: #0000FF">const</span><span style="color: #000000"> </span><span style="color: #0070C1">ZB</span><span style="color: #000000"> = </span><span style="color: #795E26">require</span><span style="color: #000000">(</span><span style="color: #A31515">&#039;zeebe-node&#039;</span><span style="color: #000000">)</span>
<span style="color: #000000">;(</span><span style="color: #0000FF">async</span><span style="color: #000000"> () </span><span style="color: #0000FF">=&gt;</span><span style="color: #000000"> {</span>
<span style="color: #000000">    </span><span style="color: #001080">console</span><span style="color: #000000">.</span><span style="color: #795E26">log</span><span style="color: #000000">(</span><span style="color: #AF00DB">await</span><span style="color: #000000"> </span><span style="color: #0070C1">ZB</span><span style="color: #000000">.</span><span style="color: #001080">BpmnParser</span><span style="color: #000000">.</span><span style="color: #795E26">generateConstantsForBpmnFiles</span><span style="color: #000000">(</span><span style="color: #001080">processFile</span><span style="color: #000000">))</span>
<span style="color: #000000">})()</span>
</code></pre>
					<p>This will produce output similar to:</p>
					<pre><code class="language-typescript"><span style="color: #008000">// Autogenerated constants for msg-start.bpmn</span>

<span style="color: #AF00DB">export</span><span style="color: #000000"> </span><span style="color: #0000FF">enum</span><span style="color: #000000"> </span><span style="color: #267F99">TaskType</span><span style="color: #000000"> = {</span>
<span style="color: #000000">    </span><span style="color: #0070C1">CONSOLE_LOG</span><span style="color: #000000"> = </span><span style="color: #A31515">&quot;console-log&quot;</span>
<span style="color: #000000">};</span>

<span style="color: #AF00DB">export</span><span style="color: #000000"> </span><span style="color: #0000FF">enum</span><span style="color: #000000"> </span><span style="color: #267F99">MessageName</span><span style="color: #000000"> = {</span>
<span style="color: #000000">    </span><span style="color: #0070C1">MSG_EMIT_FRAME</span><span style="color: #000000"> = </span><span style="color: #A31515">&quot;MSG-EMIT_FRAME&quot;</span><span style="color: #000000">,</span>
<span style="color: #000000">    </span><span style="color: #0070C1">MSG_START_JOB</span><span style="color: #000000"> = </span><span style="color: #A31515">&quot;MSG-START_JOB&quot;</span>
<span style="color: #000000">};</span>
</code></pre>
					<p><a name = "generate-code"></a></p>
					<a href="#generating-code-from-a-bpm-model-file" id="generating-code-from-a-bpm-model-file" style="color: inherit; text-decoration: none;">
						<h2>Generating code from a BPM Model file</h2>
					</a>
					<p>You can scaffold your worker code from a BPMN file with the <code>zeebe-node</code> command. To use this command, install the package globally with:</p>
					<pre><code class="language-bash"><span style="color: #000000">npm i -g zeebe-node</span>
</code></pre>
					<p>Pass in the path to the BPMN file, and it will output a file to implement it:</p>
					<pre><code class="language-bash"><span style="color: #000000">zeebe-node my-model.bpmn</span>
</code></pre>
					<p><a name = "strongly-typed"></a></p>
					<a href="#writing-strongly-typed-job-workers" id="writing-strongly-typed-job-workers" style="color: inherit; text-decoration: none;">
						<h3>Writing Strongly-typed Job Workers</h3>
					</a>
					<p>You can provide interfaces to get design-time type safety and intellisense on the process variables passed in the a worker job handler, the custom headers that it will receive, and the variables that it will pass back to Zeebe in the <code>complete.success</code> call:</p>
					<pre><code class="language-TypeScript"><span style="color: #0000FF">interface</span><span style="color: #000000"> </span><span style="color: #267F99">InputVariables</span><span style="color: #000000"> {</span>
<span style="color: #000000">    </span><span style="color: #001080">name</span><span style="color: #000000">: </span><span style="color: #267F99">string</span><span style="color: #000000">,</span>
<span style="color: #000000">    </span><span style="color: #001080">age</span><span style="color: #000000">: </span><span style="color: #267F99">number</span><span style="color: #000000">,</span>
<span style="color: #000000">    </span><span style="color: #001080">preferences</span><span style="color: #000000">: {</span>
<span style="color: #000000">        </span><span style="color: #001080">beverage</span><span style="color: #000000">: </span><span style="color: #A31515">&#039;Coffee&#039;</span><span style="color: #000000"> | </span><span style="color: #A31515">&#039;Tea&#039;</span><span style="color: #000000"> | </span><span style="color: #A31515">&#039;Beer&#039;</span><span style="color: #000000"> | </span><span style="color: #A31515">&#039;Water&#039;</span><span style="color: #000000">,</span>
<span style="color: #000000">        </span><span style="color: #001080">color</span><span style="color: #000000">: </span><span style="color: #267F99">string</span>
<span style="color: #000000">    }</span>
<span style="color: #000000">}</span>

<span style="color: #0000FF">interface</span><span style="color: #000000"> </span><span style="color: #267F99">OutputVariables</span><span style="color: #000000"> {</span>
<span style="color: #000000">    </span><span style="color: #001080">suggestedGift</span><span style="color: #000000">: </span><span style="color: #267F99">string</span>
<span style="color: #000000">}</span>

<span style="color: #0000FF">interface</span><span style="color: #000000"> </span><span style="color: #267F99">CustomHeaders</span><span style="color: #000000"> {</span>
<span style="color: #000000">    </span><span style="color: #001080">occasion</span><span style="color: #000000">: </span><span style="color: #A31515">&#039;Birthday&#039;</span><span style="color: #000000"> | </span><span style="color: #A31515">&#039;Christmas&#039;</span><span style="color: #000000"> | </span><span style="color: #A31515">&#039;Hannukah&#039;</span><span style="color: #000000"> | </span><span style="color: #A31515">&#039;Diwali&#039;</span>
<span style="color: #000000">}</span>

<span style="color: #0000FF">const</span><span style="color: #000000"> </span><span style="color: #0070C1">giftSuggester</span><span style="color: #000000"> = </span><span style="color: #001080">zbc</span><span style="color: #000000">.</span><span style="color: #001080">createWorker</span><span style="color: #000000">&lt;</span>
<span style="color: #000000">    </span><span style="color: #001080">InputVariables</span><span style="color: #000000">,</span>
<span style="color: #000000">    </span><span style="color: #001080">CustomHeaders</span><span style="color: #000000">,</span>
<span style="color: #000000">    </span><span style="color: #001080">OutputVariables</span><span style="color: #000000">&gt;</span>
<span style="color: #000000">    (</span><span style="color: #A31515">&#039;get-gift-suggestion&#039;</span><span style="color: #000000">, (</span><span style="color: #001080">job</span><span style="color: #000000">) </span><span style="color: #0000FF">=&gt;</span><span style="color: #000000"> {</span>
<span style="color: #000000">        </span><span style="color: #0000FF">const</span><span style="color: #000000"> </span><span style="color: #0070C1">suggestedGift</span><span style="color: #000000"> = </span><span style="color: #A31515">`</span><span style="color: #0000FF">${</span><span style="color: #001080">job</span><span style="color: #000000FF">.</span><span style="color: #001080">customHeaders</span><span style="color: #000000FF">.</span><span style="color: #001080">occasion</span><span style="color: #0000FF">}</span><span style="color: #A31515"> </span><span style="color: #0000FF">${</span><span style="color: #001080">job</span><span style="color: #000000FF">.</span><span style="color: #001080">variables</span><span style="color: #000000FF">.</span><span style="color: #001080">preferences</span><span style="color: #000000FF">.</span><span style="color: #001080">beverage</span><span style="color: #0000FF">}</span><span style="color: #A31515">`</span>
<span style="color: #000000">        </span><span style="color: #001080">job</span><span style="color: #000000">.</span><span style="color: #795E26">complete</span><span style="color: #000000">({ </span><span style="color: #001080">suggestedGift</span><span style="color: #000000"> })</span>
<span style="color: #000000">})</span>
</code></pre>
					<p>If you decouple the declaration of the job handler from the <code>createWorker</code> call, you will need to explicitly specify its type, like this:</p>
					<pre><code class="language-TypeScript"><span style="color: #AF00DB">import</span><span style="color: #000000"> { </span><span style="color: #001080">ZBWorkerTaskHandler</span><span style="color: #000000"> } </span><span style="color: #AF00DB">from</span><span style="color: #000000"> </span><span style="color: #A31515">&#039;zeebe-node&#039;</span>

<span style="color: #0000FF">function</span><span style="color: #000000"> </span><span style="color: #795E26">getGiftSuggestion</span><span style="color: #000000">(</span><span style="color: #001080">job</span><span style="color: #000000">): </span><span style="color: #267F99">ZBWorkerTaskHandler</span><span style="color: #000000">&lt;</span><span style="color: #267F99">InputVariables</span><span style="color: #000000">, </span><span style="color: #267F99">CustomHeaders</span><span style="color: #000000">, </span><span style="color: #267F99">OutputVariables</span><span style="color: #000000">&gt; {</span>
<span style="color: #000000">    </span><span style="color: #0000FF">const</span><span style="color: #000000"> </span><span style="color: #0070C1">suggestedGift</span><span style="color: #000000"> = </span><span style="color: #A31515">`</span><span style="color: #0000FF">${</span><span style="color: #001080">job</span><span style="color: #000000FF">.</span><span style="color: #001080">customHeaders</span><span style="color: #000000FF">.</span><span style="color: #001080">occasion</span><span style="color: #0000FF">}</span><span style="color: #A31515"> </span><span style="color: #0000FF">${</span><span style="color: #001080">job</span><span style="color: #000000FF">.</span><span style="color: #001080">variables</span><span style="color: #000000FF">.</span><span style="color: #001080">preferences</span><span style="color: #000000FF">.</span><span style="color: #001080">beverage</span><span style="color: #0000FF">}</span><span style="color: #A31515">`</span>
<span style="color: #000000">    </span><span style="color: #001080">job</span><span style="color: #000000">.</span><span style="color: #795E26">complete</span><span style="color: #000000">({ </span><span style="color: #001080">suggestedGift</span><span style="color: #000000"> })</span>
<span style="color: #000000">}</span>

<span style="color: #0000FF">const</span><span style="color: #000000"> </span><span style="color: #0070C1">giftSuggester</span><span style="color: #000000"> = </span><span style="color: #001080">zbc</span><span style="color: #000000">.</span><span style="color: #795E26">createWorker</span><span style="color: #000000">({</span>
<span style="color: #000000">    </span><span style="color: #001080">taskType:</span><span style="color: #000000"> </span><span style="color: #A31515">&#039;get-gift-suggestion&#039;</span><span style="color: #000000">,</span>
<span style="color: #000000">    </span><span style="color: #001080">taskHandler:</span><span style="color: #000000"> </span><span style="color: #001080">getGiftSuggestion</span>
<span style="color: #000000">})</span>
</code></pre>
					<p><a name = "run-time-safety"></a></p>
					<a href="#run-time-type-safety" id="run-time-type-safety" style="color: inherit; text-decoration: none;">
						<h2>Run-time Type Safety</h2>
					</a>
					<p>The parameterization of the client and workers helps to catch errors in code, and if your interface definitions are good, can go a long way to making sure that your workers and client emit the correct payloads and have a strong expectation about what they will receive, but it does not give you any <em>run-time safety</em>.</p>
					<p>Your type definition may be incorrect, or the variables or custom headers may simply not be there at run-time, as there is no type checking in the broker, and other factors are involved, such as tasks with input and output mappings, and data added to the process variables by REST calls and other workers.</p>
					<p>You should consider:</p>
					<ul>
						<li>Writing interface definitions for your payloads to get design-time assist for protection against spelling errors as you demarshal and update variables.</li>
						<li>Testing for the existence of variables and properties on payloads, and writing defensive pathways to deal with missing properties. If you mark <em>everything</em> as optional in your interfaces, the type-checker will force you to write that code.</li>
						<li>Surfacing code exceptions operationally to detect and diagnose mismatched expectations.</li>
						<li>If you want to validate inputs and outputs to your system at runtime, you can use <a href="https://github.com/gcanti/io-ts">io-ts</a>. Once data goes into that, it either exits through an exception handler, or is guaranteed to have the shape of the defined codec at run-time.</li>
					</ul>
					<p>As with everything, it is a balancing act / trade-off between correctness, safety, and speed. You do not want to lock everything down while you are still exploring.</p>
					<p>I recommend the following scale, to match the maturity of your system:</p>
					<ul>
						<li>Start with <code>&lt;any&gt;</code> typing for the workers; then</li>
						<li>Develop interfaces to describe the DTOs represented in your process variables;</li>
						<li>Use optional types on those interfaces to check your defensive programming structures;</li>
						<li>Lock down the run-time behaviour with io-ts as the boundary validator.</li>
					</ul>
					<p>You may choose to start with the DTOs. Anyway, there are options.</p>
					<p><a name = "developing"></a></p>
					<a href="#developing-zeebe-node" id="developing-zeebe-node" style="color: inherit; text-decoration: none;">
						<h2>Developing Zeebe Node</h2>
					</a>
					<p>The source is written in TypeScript in <code>src</code>, and compiled to ES6 in the <code>dist</code> directory.</p>
					<p>To build:</p>
					<pre><code class="language-bash"><span style="color: #000000">npm run build</span>
</code></pre>
					<p>To start a watcher to build the source and API docs while you are developing:</p>
					<pre><code class="language-bash"><span style="color: #000000">npm run dev</span>
</code></pre>
					<p><a name = "tests"></a></p>
					<a href="#tests" id="tests" style="color: inherit; text-decoration: none;">
						<h3>Tests</h3>
					</a>
					<p>Tests are written in Jest, and live in the <code>src/__tests__</code> directory. To run the unit tests:</p>
					<pre><code class="language-bash"><span style="color: #000000">npm t</span>
</code></pre>
					<p>Integration tests are in the <code>src/__tests__/integration</code> directory.</p>
					<p>They require a Zeebe broker to run. You can start a dockerised broker:</p>
					<pre><code class="language-bash"><span style="color: #795E26">cd</span><span style="color: #000000"> docker</span>
<span style="color: #000000">docker-compose up</span>
</code></pre>
					<p>And then run them manually:</p>
					<pre><code class="language-bash"><span style="color: #000000">npm run test:integration</span>
</code></pre>
					<p>For the failure test, you need to run Operate and manually verify that an incident has been raised.</p>
					<p><a name = "writing-tests"></a></p>
					<a href="#writing-tests" id="writing-tests" style="color: inherit; text-decoration: none;">
						<h3>Writing Tests</h3>
					</a>
					<p>Zeebe is inherently stateful, so integration tests need to be carefully isolated so that workers from one test do not service tasks in another test. Jest runs tests in a random order, so intermittent failures are the outcome of tests that mutate shared state.</p>
					<p>The tests use a templating function to replace the process id, task types and message names in the bpmn model to produce distinct, isolated namespaces for each test and each test run.</p>
					<p><a name = "contributors"></a></p>
					<a href="#contributors" id="contributors" style="color: inherit; text-decoration: none;">
						<h2>Contributors</h2>
					</a>
					<table>
						<thead>
							<tr>
								<th>Name</th>
							</tr>
						</thead>
						<tbody><tr>
								<td><strong><a href="https://github.com/jwulf">Josh Wulf</a></strong></td>
							</tr>
							<tr>
								<td><strong><a href="https://github.com/ColRad">Colin Raddatz</a></strong></td>
							</tr>
							<tr>
								<td><strong><a href="https://github.com/BrighTide">Jarred Filmer</a></strong></td>
							</tr>
							<tr>
								<td><strong><a href="https://github.com/s3than">Timothy Colbert</a></strong></td>
							</tr>
							<tr>
								<td><strong><a href="https://github.com/OlivierAlbertini">Olivier Albertini</a></strong></td>
							</tr>
							<tr>
								<td><strong><a href="https://github.com/pedesen">Patrick Dehn</a></strong></td>
							</tr>
					</tbody></table>
			</div>
		</div>
		<div class="col-4 col-menu menu-sticky-wrap menu-highlight">
			<nav class="tsd-navigation primary">
				<ul>
					<li class=" ">
						<a href="modules.html">Exports</a>
					</li>
				</ul>
			</nav>
			<nav class="tsd-navigation secondary menu-sticky">
				<ul class="before-current">
					<li class=" tsd-kind-enum">
						<a href="enums/PartitionBrokerHealth.html" class="tsd-kind-icon">Partition<wbr>Broker<wbr>Health</a>
					</li>
					<li class=" tsd-kind-enum">
						<a href="enums/PartitionBrokerRole.html" class="tsd-kind-icon">Partition<wbr>Broker<wbr>Role</a>
					</li>
					<li class=" tsd-kind-class">
						<a href="classes/BpmnParser.html" class="tsd-kind-icon">Bpmn<wbr>Parser</a>
					</li>
					<li class=" tsd-kind-class">
						<a href="classes/ZBClient.html" class="tsd-kind-icon">ZBClient</a>
					</li>
					<li class=" tsd-kind-class">
						<a href="classes/ZBLogger.html" class="tsd-kind-icon">ZBLogger</a>
					</li>
					<li class=" tsd-kind-class tsd-has-type-parameter">
						<a href="classes/ZBWorker.html" class="tsd-kind-icon">ZBWorker</a>
					</li>
					<li class=" tsd-kind-interface">
						<a href="interfaces/ActivateInstruction.html" class="tsd-kind-icon">Activate<wbr>Instruction</a>
					</li>
					<li class=" tsd-kind-interface">
						<a href="interfaces/ActivateJobsRequest.html" class="tsd-kind-icon">Activate<wbr>Jobs<wbr>Request</a>
					</li>
					<li class=" tsd-kind-interface">
						<a href="interfaces/ActivateJobsResponse.html" class="tsd-kind-icon">Activate<wbr>Jobs<wbr>Response</a>
					</li>
					<li class=" tsd-kind-interface">
						<a href="interfaces/ActivatedJob.html" class="tsd-kind-icon">Activated<wbr>Job</a>
					</li>
					<li class=" tsd-kind-interface">
						<a href="interfaces/BasicAuthConfig.html" class="tsd-kind-icon">Basic<wbr>Auth<wbr>Config</a>
					</li>
					<li class=" tsd-kind-interface">
						<a href="interfaces/BroadcastSignalReq.html" class="tsd-kind-icon">Broadcast<wbr>Signal<wbr>Req</a>
					</li>
					<li class=" tsd-kind-interface">
						<a href="interfaces/BroadcastSignalRequest.html" class="tsd-kind-icon">Broadcast<wbr>Signal<wbr>Request</a>
					</li>
					<li class=" tsd-kind-interface">
						<a href="interfaces/BroadcastSignalRes.html" class="tsd-kind-icon">Broadcast<wbr>Signal<wbr>Res</a>
					</li>
					<li class=" tsd-kind-interface">
						<a href="interfaces/BroadcastSignalResponse.html" class="tsd-kind-icon">Broadcast<wbr>Signal<wbr>Response</a>
					</li>
					<li class=" tsd-kind-interface">
						<a href="interfaces/BrokerInfo.html" class="tsd-kind-icon">Broker<wbr>Info</a>
					</li>
					<li class=" tsd-kind-interface">
						<a href="interfaces/CamundaCloudConfig.html" class="tsd-kind-icon">Camunda<wbr>Cloud<wbr>Config</a>
					</li>
					<li class=" tsd-kind-interface tsd-has-type-parameter">
						<a href="interfaces/CompleteJobRequest.html" class="tsd-kind-icon">Complete<wbr>Job<wbr>Request</a>
					</li>
					<li class=" tsd-kind-interface tsd-has-type-parameter">
						<a href="interfaces/CreateProcessBaseRequest.html" class="tsd-kind-icon">Create<wbr>Process<wbr>Base<wbr>Request</a>
					</li>
					<li class=" tsd-kind-interface">
						<a href="interfaces/CreateProcessInstanceBaseRequest.html" class="tsd-kind-icon">Create<wbr>Process<wbr>Instance<wbr>Base<wbr>Request</a>
					</li>
					<li class=" tsd-kind-interface tsd-has-type-parameter">
						<a href="interfaces/CreateProcessInstanceReq.html" class="tsd-kind-icon">Create<wbr>Process<wbr>Instance<wbr>Req</a>
					</li>
					<li class=" tsd-kind-interface">
						<a href="interfaces/CreateProcessInstanceRequest.html" class="tsd-kind-icon">Create<wbr>Process<wbr>Instance<wbr>Request</a>
					</li>
					<li class=" tsd-kind-interface">
						<a href="interfaces/CreateProcessInstanceResponse.html" class="tsd-kind-icon">Create<wbr>Process<wbr>Instance<wbr>Response</a>
					</li>
					<li class=" tsd-kind-interface tsd-has-type-parameter">
						<a href="interfaces/CreateProcessInstanceWithResultReq.html" class="tsd-kind-icon">Create<wbr>Process<wbr>Instance<wbr>With<wbr>Result<wbr>Req</a>
					</li>
					<li class=" tsd-kind-interface">
						<a href="interfaces/CreateProcessInstanceWithResultRequest.html" class="tsd-kind-icon">Create<wbr>Process<wbr>Instance<wbr>With<wbr>Result<wbr>Request</a>
					</li>
					<li class=" tsd-kind-interface tsd-has-type-parameter">
						<a href="interfaces/CreateProcessInstanceWithResultResponse.html" class="tsd-kind-icon">Create<wbr>Process<wbr>Instance<wbr>With<wbr>Result<wbr>Response</a>
					</li>
					<li class=" tsd-kind-interface">
						<a href="interfaces/DecisionDeployment.html" class="tsd-kind-icon">Decision<wbr>Deployment</a>
					</li>
					<li class=" tsd-kind-interface">
						<a href="interfaces/DecisionMetadata.html" class="tsd-kind-icon">Decision<wbr>Metadata</a>
					</li>
					<li class=" tsd-kind-interface">
						<a href="interfaces/DecisionRequirementsDeployment.html" class="tsd-kind-icon">Decision<wbr>Requirements<wbr>Deployment</a>
					</li>
					<li class=" tsd-kind-interface">
						<a href="interfaces/DecisionRequirementsMetadata.html" class="tsd-kind-icon">Decision<wbr>Requirements<wbr>Metadata</a>
					</li>
					<li class=" tsd-kind-interface">
						<a href="interfaces/DeployProcessBuffer.html" class="tsd-kind-icon">Deploy<wbr>Process<wbr>Buffer</a>
					</li>
					<li class=" tsd-kind-interface">
						<a href="interfaces/DeployProcessRequest.html" class="tsd-kind-icon">Deploy<wbr>Process<wbr>Request</a>
					</li>
					<li class=" tsd-kind-interface">
						<a href="interfaces/DeployProcessResponse.html" class="tsd-kind-icon">Deploy<wbr>Process<wbr>Response</a>
					</li>
					<li class=" tsd-kind-interface">
						<a href="interfaces/DeployResourceRequest.html" class="tsd-kind-icon">Deploy<wbr>Resource<wbr>Request</a>
					</li>
					<li class=" tsd-kind-interface tsd-has-type-parameter">
						<a href="interfaces/DeployResourceResponse.html" class="tsd-kind-icon">Deploy<wbr>Resource<wbr>Response</a>
					</li>
					<li class=" tsd-kind-interface">
						<a href="interfaces/ErrorJobWithVariables.html" class="tsd-kind-icon">Error<wbr>Job<wbr>With<wbr>Variables</a>
					</li>
					<li class=" tsd-kind-interface">
						<a href="interfaces/EvaluateDecisionResponse.html" class="tsd-kind-icon">Evaluate<wbr>Decision<wbr>Response</a>
					</li>
					<li class=" tsd-kind-interface">
						<a href="interfaces/EvaluatedDecision.html" class="tsd-kind-icon">Evaluated<wbr>Decision</a>
					</li>
					<li class=" tsd-kind-interface">
						<a href="interfaces/EvaluatedDecisionInput.html" class="tsd-kind-icon">Evaluated<wbr>Decision<wbr>Input</a>
					</li>
					<li class=" tsd-kind-interface">
						<a href="interfaces/EvaluatedDecisionOutput.html" class="tsd-kind-icon">Evaluated<wbr>Decision<wbr>Output</a>
					</li>
					<li class=" tsd-kind-interface">
						<a href="interfaces/FailJobRequest.html" class="tsd-kind-icon">Fail<wbr>Job<wbr>Request</a>
					</li>
					<li class=" tsd-kind-interface">
						<a href="interfaces/FormDeployment.html" class="tsd-kind-icon">Form<wbr>Deployment</a>
					</li>
					<li class=" tsd-kind-interface">
						<a href="interfaces/FormMetadata.html" class="tsd-kind-icon">Form<wbr>Metadata</a>
					</li>
					<li class=" tsd-kind-interface">
						<a href="interfaces/ICustomHeaders.html" class="tsd-kind-icon">ICustom<wbr>Headers</a>
					</li>
					<li class=" tsd-kind-interface">
						<a href="interfaces/IInputVariables.html" class="tsd-kind-icon">IInput<wbr>Variables</a>
					</li>
					<li class=" tsd-kind-interface">
						<a href="interfaces/IOutputVariables.html" class="tsd-kind-icon">IOutput<wbr>Variables</a>
					</li>
					<li class=" tsd-kind-interface">
						<a href="interfaces/IProcessVariables.html" class="tsd-kind-icon">IProcess<wbr>Variables</a>
					</li>
					<li class=" tsd-kind-interface">
						<a href="interfaces/JSONDoc.html" class="tsd-kind-icon">JSONDoc</a>
					</li>
					<li class=" tsd-kind-interface tsd-has-type-parameter">
						<a href="interfaces/Job.html" class="tsd-kind-icon">Job</a>
					</li>
					<li class=" tsd-kind-interface tsd-has-type-parameter">
						<a href="interfaces/JobCompletionInterface.html" class="tsd-kind-icon">Job<wbr>Completion<wbr>Interface</a>
					</li>
					<li class=" tsd-kind-interface">
						<a href="interfaces/JobFailureConfiguration.html" class="tsd-kind-icon">Job<wbr>Failure<wbr>Configuration</a>
					</li>
					<li class=" tsd-kind-interface">
						<a href="interfaces/KeyedObject.html" class="tsd-kind-icon">Keyed<wbr>Object</a>
					</li>
					<li class=" tsd-kind-interface">
						<a href="interfaces/ListProcessResponse.html" class="tsd-kind-icon">List<wbr>Process<wbr>Response</a>
					</li>
					<li class=" tsd-kind-interface">
						<a href="interfaces/MatchedDecisionRule.html" class="tsd-kind-icon">Matched<wbr>Decision<wbr>Rule</a>
					</li>
					<li class=" tsd-kind-interface">
						<a href="interfaces/ModifyProcessInstanceRequest.html" class="tsd-kind-icon">Modify<wbr>Process<wbr>Instance<wbr>Request</a>
					</li>
					<li class=" tsd-kind-interface">
						<a href="interfaces/ModifyProcessInstanceResponse.html" class="tsd-kind-icon">Modify<wbr>Process<wbr>Instance<wbr>Response</a>
					</li>
					<li class=" tsd-kind-interface">
						<a href="interfaces/OperationOptionsNoRetry.html" class="tsd-kind-icon">Operation<wbr>Options<wbr>NoRetry</a>
					</li>
					<li class=" tsd-kind-interface">
						<a href="interfaces/OperationOptionsWithRetry.html" class="tsd-kind-icon">Operation<wbr>Options<wbr>With<wbr>Retry</a>
					</li>
					<li class=" tsd-kind-interface">
						<a href="interfaces/Partition.html" class="tsd-kind-icon">Partition</a>
					</li>
					<li class=" tsd-kind-interface">
						<a href="interfaces/ProcessDeployment.html" class="tsd-kind-icon">Process<wbr>Deployment</a>
					</li>
					<li class=" tsd-kind-interface">
						<a href="interfaces/ProcessInstanceCreationStartInstruction.html" class="tsd-kind-icon">Process<wbr>Instance<wbr>Creation<wbr>Start<wbr>Instruction</a>
					</li>
					<li class=" tsd-kind-interface">
						<a href="interfaces/ProcessMetadata.html" class="tsd-kind-icon">Process<wbr>Metadata</a>
					</li>
					<li class=" tsd-kind-interface">
						<a href="interfaces/ProcessRequestObject.html" class="tsd-kind-icon">Process<wbr>Request<wbr>Object</a>
					</li>
					<li class=" tsd-kind-interface tsd-has-type-parameter">
						<a href="interfaces/PublishMessageRequest.html" class="tsd-kind-icon">Publish<wbr>Message<wbr>Request</a>
					</li>
					<li class=" tsd-kind-interface">
						<a href="interfaces/PublishMessageResponse.html" class="tsd-kind-icon">Publish<wbr>Message<wbr>Response</a>
					</li>
					<li class=" tsd-kind-interface tsd-has-type-parameter">
						<a href="interfaces/PublishStartMessageRequest.html" class="tsd-kind-icon">Publish<wbr>Start<wbr>Message<wbr>Request</a>
					</li>
					<li class=" tsd-kind-interface">
						<a href="interfaces/ResolveIncidentRequest.html" class="tsd-kind-icon">Resolve<wbr>Incident<wbr>Request</a>
					</li>
					<li class=" tsd-kind-interface">
						<a href="interfaces/Resource.html" class="tsd-kind-icon">Resource</a>
					</li>
					<li class=" tsd-kind-interface tsd-has-type-parameter">
						<a href="interfaces/SetVariablesRequest.html" class="tsd-kind-icon">Set<wbr>Variables<wbr>Request</a>
					</li>
					<li class=" tsd-kind-interface">
						<a href="interfaces/StreamActivatedJobsRequest.html" class="tsd-kind-icon">Stream<wbr>Activated<wbr>Jobs<wbr>Request</a>
					</li>
					<li class=" tsd-kind-interface">
						<a href="interfaces/TerminateInstruction.html" class="tsd-kind-icon">Terminate<wbr>Instruction</a>
					</li>
					<li class=" tsd-kind-interface">
						<a href="interfaces/ThrowErrorRequest.html" class="tsd-kind-icon">Throw<wbr>Error<wbr>Request</a>
					</li>
					<li class=" tsd-kind-interface">
						<a href="interfaces/TopologyResponse.html" class="tsd-kind-icon">Topology<wbr>Response</a>
					</li>
					<li class=" tsd-kind-interface">
						<a href="interfaces/UpdateJobRetriesRequest.html" class="tsd-kind-icon">Update<wbr>Job<wbr>Retries<wbr>Request</a>
					</li>
					<li class=" tsd-kind-interface">
						<a href="interfaces/VariableInstruction.html" class="tsd-kind-icon">Variable<wbr>Instruction</a>
					</li>
					<li class=" tsd-kind-interface tsd-has-type-parameter">
						<a href="interfaces/ZBBatchWorkerConfig.html" class="tsd-kind-icon">ZBBatch<wbr>Worker<wbr>Config</a>
					</li>
					<li class=" tsd-kind-interface">
						<a href="interfaces/ZBClientOptions.html" class="tsd-kind-icon">ZBClient<wbr>Options</a>
					</li>
					<li class=" tsd-kind-interface">
						<a href="interfaces/ZBCustomLogger.html" class="tsd-kind-icon">ZBCustom<wbr>Logger</a>
					</li>
					<li class=" tsd-kind-interface">
						<a href="interfaces/ZBGrpc.html" class="tsd-kind-icon">ZBGrpc</a>
					</li>
					<li class=" tsd-kind-interface">
						<a href="interfaces/ZBLogMessage.html" class="tsd-kind-icon">ZBLog<wbr>Message</a>
					</li>
					<li class=" tsd-kind-interface">
						<a href="interfaces/ZBLoggerConfig.html" class="tsd-kind-icon">ZBLogger<wbr>Config</a>
					</li>
					<li class=" tsd-kind-interface">
						<a href="interfaces/ZBLoggerOptions.html" class="tsd-kind-icon">ZBLogger<wbr>Options</a>
					</li>
					<li class=" tsd-kind-interface tsd-has-type-parameter">
						<a href="interfaces/ZBWorkerBaseConfig.html" class="tsd-kind-icon">ZBWorker<wbr>Base<wbr>Config</a>
					</li>
					<li class=" tsd-kind-interface tsd-has-type-parameter">
						<a href="interfaces/ZBWorkerConfig.html" class="tsd-kind-icon">ZBWorker<wbr>Config</a>
					</li>
					<li class=" tsd-kind-interface tsd-has-type-parameter">
						<a href="interfaces/ZBWorkerOptions.html" class="tsd-kind-icon">ZBWorker<wbr>Options</a>
					</li>
					<li class=" tsd-kind-interface tsd-has-type-parameter">
						<a href="interfaces/ZeebeJob.html" class="tsd-kind-icon">Zeebe<wbr>Job</a>
					</li>
					<li class=" tsd-kind-type-alias tsd-has-type-parameter">
						<a href="modules.html#BatchedJob" class="tsd-kind-icon">Batched<wbr>Job</a>
					</li>
					<li class=" tsd-kind-type-alias">
						<a href="modules.html#ConnectionErrorHandler" class="tsd-kind-icon">Connection<wbr>Error<wbr>Handler</a>
					</li>
					<li class=" tsd-kind-type-alias">
						<a href="modules.html#DeployProcessFiles" class="tsd-kind-icon">Deploy<wbr>Process<wbr>Files</a>
					</li>
					<li class=" tsd-kind-type-alias">
						<a href="modules.html#Deployment" class="tsd-kind-icon">Deployment</a>
					</li>
					<li class=" tsd-kind-type-alias">
						<a href="modules.html#ErrorJobOutcome" class="tsd-kind-icon">Error<wbr>Job<wbr>Outcome</a>
					</li>
					<li class=" tsd-kind-type-alias">
						<a href="modules.html#EvaluateDecisionRequest" class="tsd-kind-icon">Evaluate<wbr>Decision<wbr>Request</a>
					</li>
					<li class=" tsd-kind-type-alias">
						<a href="modules.html#JSON" class="tsd-kind-icon">JSON</a>
					</li>
					<li class=" tsd-kind-type-alias">
						<a href="modules.html#Loglevel" class="tsd-kind-icon">Loglevel</a>
					</li>
					<li class=" tsd-kind-type-alias">
						<a href="modules.html#MustReturnJobActionAcknowledgement" class="tsd-kind-icon">Must<wbr>Return<wbr>Job<wbr>Action<wbr>Acknowledgement</a>
					</li>
					<li class=" tsd-kind-type-alias">
						<a href="modules.html#OperationOptions" class="tsd-kind-icon">Operation<wbr>Options</a>
					</li>
					<li class=" tsd-kind-type-alias tsd-has-type-parameter">
						<a href="modules.html#ZBBatchWorkerTaskHandler" class="tsd-kind-icon">ZBBatch<wbr>Worker<wbr>Task<wbr>Handler</a>
					</li>
					<li class=" tsd-kind-type-alias tsd-has-type-parameter">
						<a href="modules.html#ZBWorkerTaskHandler" class="tsd-kind-icon">ZBWorker<wbr>Task<wbr>Handler</a>
					</li>
					<li class=" tsd-kind-variable">
						<a href="modules.html#ConnectionStatusEvent" class="tsd-kind-icon">Connection<wbr>Status<wbr>Event</a>
					</li>
					<li class=" tsd-kind-variable tsd-is-external">
						<a href="modules.html#Duration" class="tsd-kind-icon">Duration</a>
					</li>
					<li class=" tsd-kind-variable">
						<a href="modules.html#JOB_ACTION_ACKNOWLEDGEMENT" class="tsd-kind-icon">JOB_<wbr>ACTION_<wbr>ACKNOWLEDGEMENT</a>
					</li>
					<li class=" tsd-kind-variable">
						<a href="modules.html#ZBJsonLogger" class="tsd-kind-icon">ZBJson<wbr>Logger</a>
					</li>
					<li class=" tsd-kind-variable">
						<a href="modules.html#ZBSimpleLogger" class="tsd-kind-icon">ZBSimple<wbr>Logger</a>
					</li>
				</ul>
			</nav>
		</div>
	</div>
</div>
<footer class="with-border-bottom">
	<div class="container">
		<h2>Legend</h2>
		<div class="tsd-legend-group">
			<ul class="tsd-legend">
				<li class="tsd-kind-constructor tsd-parent-kind-class"><span class="tsd-kind-icon">Constructor</span></li>
				<li class="tsd-kind-property tsd-parent-kind-class"><span class="tsd-kind-icon">Property</span></li>
				<li class="tsd-kind-method tsd-parent-kind-class"><span class="tsd-kind-icon">Method</span></li>
			</ul>
			<ul class="tsd-legend">
				<li class="tsd-kind-property tsd-parent-kind-interface"><span class="tsd-kind-icon">Property</span></li>
				<li class="tsd-kind-method tsd-parent-kind-interface"><span class="tsd-kind-icon">Method</span></li>
			</ul>
			<ul class="tsd-legend">
				<li class="tsd-kind-property tsd-parent-kind-class tsd-is-inherited"><span class="tsd-kind-icon">Inherited property</span></li>
				<li class="tsd-kind-method tsd-parent-kind-class tsd-is-inherited"><span class="tsd-kind-icon">Inherited method</span></li>
			</ul>
			<ul class="tsd-legend">
				<li class="tsd-kind-property tsd-parent-kind-class tsd-is-private"><span class="tsd-kind-icon">Private property</span></li>
				<li class="tsd-kind-method tsd-parent-kind-class tsd-is-private"><span class="tsd-kind-icon">Private method</span></li>
			</ul>
			<ul class="tsd-legend">
				<li class="tsd-kind-property tsd-parent-kind-class tsd-is-static"><span class="tsd-kind-icon">Static property</span></li>
				<li class="tsd-kind-method tsd-parent-kind-class tsd-is-static"><span class="tsd-kind-icon">Static method</span></li>
			</ul>
			<ul class="tsd-legend">
				<li class="tsd-kind-method tsd-parent-kind-class tsd-is-protected"><span class="tsd-kind-icon">Protected method</span></li>
			</ul>
		</div>
	</div>
</footer>
<div class="container tsd-generator">
	<p>Generated using <a href="https://typedoc.org/" target="_blank">TypeDoc</a></p>
</div>
<div class="overlay"></div>
<script src="assets/js/main.js"></script>
</body>
</html>